<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SmtpHelper :: Eclipse Scout</title>
    <link rel="prev" href="security.html">
    <link rel="next" href="observability.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Eclipse Scout Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search Docs">
      		  <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:scout-docs"> In this project
          </label>
        </div>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="logo" href="https://eclipse.dev/scout/"><img src="../../../25.2/index.html/../../../_/img/eclipse-scout-logo.svg" alt="Eclipse Scout"></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="scout-docs" data-version="23.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Eclipse Scout</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../getstarted/getstarted.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout.html">Hello Scout Classic</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/deploy-to-tomcat.html">Build Scout App and Deploy to Tomcat</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/one-day-tutorial.html">One Day Tutorial</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-js.html">Hello Scout JS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-js-fullstack.html">Hello Scout JS Full Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-cdn.html">Hello Scout JS with a CDN</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../technical-guide.html">Technical Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Common Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="platform.html">Platform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="exception-handling.html">Working with exceptions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="job-manager.html">JobManager</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-context.html">RunContext</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-monitor.html">RunMonitor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="security.html">Security</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="smtp-helper.html">SmtpHelper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="observability.html">Observability</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">User Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/widget.html">Widget</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/object-factory.html">Object Factory</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/form.html">Form</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/form-field.html">Form Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/composite-field.html">Composite Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/group-box.html">Group Box</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/logical-grid.html">Logical Grid</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/value-field.html">Value Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/desktop.html">Desktop</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/outline.html">Outline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/page.html">Page</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/styling.html">Styling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/mobile.html">Mobile Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/extensibility.html">Extensibility</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/texts.html">Texts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/icons.html">Icons</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/widget-reference.html">Widget Reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/html-document-parser.html">HTML Document Parser</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/typescript.html">TypeScript Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/build-stack.html">Build Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/browser-support.html">Browser Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Working with Data</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/lookup-call.html">Lookup Call</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/code-type.html">Code Type</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/client-notification.html">Client Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/data-object.html">Data Objects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/rest.html">REST</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/jax-ws.html">Webservices with JAX-WS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../sdk/sdk.html">Scout SDK</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sdk/sdk-intellij.html">Scout SDK for IntelliJ</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sdk/sdk-eclipse.html">Scout SDK for Eclipse</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../howtos/how-tos.html">How-Tos</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/smart-field-how-to.html">SmartField: How to Apply Colors and Styles From a Lookup Row</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/js-form-how-to.html">How to open a Scout JS form in a Scout Classic application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-js/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-js/flip-card-how-to.html">How to Create a Custom Field</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../releasenotes/release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../migration/migration-guide.html">Migration Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Eclipse Scout</span>
    <span class="version">23.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../../25.2/index.html">Eclipse Scout</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../26.1/index.html">26.1</a>
        </li>
        <li class="version is-latest">
          <a href="../../../25.2/index.html">25.2</a>
        </li>
        <li class="version">
          <a href="../../../25.1/index.html">25.1</a>
        </li>
        <li class="version">
          <a href="../../../24.2/index.html">24.2</a>
        </li>
        <li class="version">
          <a href="../../../24.1/index.html">24.1</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">23.2</a>
        </li>
        <li class="version">
          <a href="../../../23.1/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../../22/index.html">22</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../25.2/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Eclipse Scout</a></li>
    <li><a href="../technical-guide.html">Technical Guide</a></li>
    <li>Common Concepts</li>
    <li><a href="smtp-helper.html">SmtpHelper</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">23.2</button>
  <div class="version-menu">
    <a class="version" href="../../../26.1/technical-guide/common-concepts/smtp-helper.html">26.1</a>
    <a class="version" href="../../../25.2/technical-guide/common-concepts/smtp-helper.html">25.2</a>
    <a class="version" href="../../../25.1/technical-guide/common-concepts/smtp-helper.html">25.1</a>
    <a class="version" href="../../../24.2/technical-guide/common-concepts/smtp-helper.html">24.2</a>
    <a class="version" href="../../../24.1/technical-guide/common-concepts/smtp-helper.html">24.1</a>
    <a class="version is-current" href="smtp-helper.html">23.2</a>
    <a class="version" href="../../../23.1/technical-guide/common-concepts/smtp-helper.html">23.1</a>
    <a class="version" href="../../../22/technical-guide/common-concepts/smtp-helper.html">22</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/eclipse-scout/scout.docs/edit/releases/23.2/docs/modules/technical-guide/pages/common-concepts/smtp-helper.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">SmtpHelper</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This document is referring to a past Scout release. Please click <a href="../../../25.2/technical-guide/common-concepts/smtp-helper.html" class="xref page">here</a> for the recent version.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>org.eclipse.scout.rt.mail.smtp.SmtpHelper</code> is an <code>@ApplicationScoped</code> Bean that provides means of sending emails described by <code>javax.mail.internet.MimeMessage</code> objects via SMTP.
The SMTP connection can either be provided as a <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code> object containing all the required connection parameters or as an already created <code>javax.mail.Session</code> object.
The <code>SmtpHelper</code> also supports pooling of SMTP connections as described in the section <a href="#connection-pooling-chapter">Connection Pooling</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smtpserverconfig"><a class="anchor" href="#smtpserverconfig"></a>SmtpServerConfig</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code> class allows to specify details of an SMTP connection to be made. It supports the following properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname or ip address of the SMTP server to use.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost</code> or <code>192.168.10.199</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The TCP port the SMTP server listens on.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. 25 or 465.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username to use for authentication.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password to use for authentication.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">useAuthentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to use authentication or not. This setting is only effective, if a username has been provided.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">useSmtps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the protocol will be 'smtps', else the protocol will be 'smtp'.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">useStartTls</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, STARTTLS will be used to create the connection to the SMTP server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sslProtocols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limits the SSL protocols to support when connecting to the SMTP server. The value is a space separated list of protocol names returned by the <code>javax.net.ssl.SSLSocket.getSupportedProtocols()</code> method.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. "TLSv1.1 TLSv1.2"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">additionalSessionProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be used to specify any other property for the <code>javax.mail.Session</code> that is created from <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code>. These additional properties are applied after all the other properties, thus may override already specified properties.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"mail.smtp.socketFactory.class": "com.example.net.SocketFactory"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">poolSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to specify the size of the connection pool for this <code>SmtpServerConfig</code>. The Default value is 0 which effectively deactives connection pooling.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxMessagesPerConnection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to specify the max number of messages to be sent per connection when using connection pooling (<code>poolSize</code> &gt; 0). The default value is 0 which effectively disables limiting the maximum number of messages sent per connection. You should consult with the operator of the SMTP server you are using to define this value. Local mail servers probably allow less than 20 messages per connection, bigger white mailers may allow up to 100 or even more.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#lst-SmtpServerConfig.example">Listing 1</a> demonstrates how to use the SmtpServerConfig class.</p>
</div>
<div id="lst-SmtpServerConfig.example" class="listingblock">
<div class="title">Listing 1. Create and configure an instance of <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SuppressWarnings("unused")
SmtpServerConfig smtpServerConfig = BEANS.get(SmtpServerConfig.class)
    .withHost("mail.example.com")
    .withPort(465)
    .withUsername("smtpuser")
    .withPassword("smtpuserpwd")
    .withUseAuthentication(true)
    .withUseSmtps(true)
    .withUseStartTls(true);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sending-messages"><a class="anchor" href="#sending-messages"></a>Sending messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Messages can be sent using the <code>sendMessage</code> Methods of the <code>SmtpHelper</code> class. In Order to prepare the message to be sent, Scout provides a number of classes and helpers:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.eclipse.scout.rt.mail.MailMessage</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Encapsulates all the information about a single mail message (sender, recipient, carbon-copy recipients, subject, body, attachments, etc.).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.eclipse.scout.rt.mail.MailParticipant</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines email address and name of a mail participant. A participant can be a recipient, a carbon-copy recipient, a blind-carbon-copy recipient, the sender and a replyTo contact.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.eclipse.scout.rt.mail.MailAttachment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains information about an email attachment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.eclipse.scout.rt.mail.MailHelper</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides various helper methods around email bodies, attachments, etc.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#lst-SmtpHelper.prepareMimeMessage">Listing 2</a> shows the usage of the mentioned classes Scout provides in order to create a MimeMessage object.</p>
</div>
<div id="lst-SmtpHelper.prepareMimeMessage" class="listingblock">
<div class="title">Listing 2. Create <code>org.eclipse.scout.rt.mail.CharsetSafeMimeMessage</code> object</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// create BinaryResource for an attachment.
BinaryResource screenshotResource = BinaryResources.create()
    .withFilename("screenshot.jpg")
    .withContentType("image/jpeg")
    .withContent(bytes)
    .build();

// wrap BinaryResource in MailAttachment
MailAttachment screenshotAttachment = new MailAttachment(screenshotResource);

// prepare Scout MailMessage
MailMessage mailMessage = BEANS.get(MailMessage.class)
    .withSender(BEANS.get(MailParticipant.class).withName("sender").withEmail("me@example.com"))
    .addToRecipient(BEANS.get(MailParticipant.class).withName("recipient").withEmail("somebody@example.com"))
    .withAttachment(screenshotAttachment)
    .withSubject("Screenshot")
    .withBodyPlainText("Dear recipient,\n\nPlease have a look at my screenshot!\n\nRegards,\nsender");

// convert MailMessage to MimeMessage
CharsetSafeMimeMessage mimeMessage = BEANS.get(MailHelper.class).createMimeMessage(mailMessage);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to send the message you can either use a <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code> object or an existing <code>javax.mail.Session</code> object as demonstrated in <a href="#lst-SmtpHelper.sendWithSmtpServerConfig">Listing 3</a> and <a href="#lst-SmtpHelper.sendWithSession">Listing 4</a>.</p>
</div>
<div id="lst-SmtpHelper.sendWithSmtpServerConfig" class="listingblock">
<div class="title">Listing 3. Send email using an <code>org.eclipse.scout.rt.mail.smtp.SmtpServerConfig</code> object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">BEANS.get(SmtpHelper.class).sendMessage(smtpServerConfig, mimeMessage);</code></pre>
</div>
</div>
<div id="lst-SmtpHelper.sendWithSession" class="listingblock">
<div class="title">Listing 4. Send email using an existing <code>javax.mail.Session</code> object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// The password has to be provided additionally as it is not stored in the session object.
BEANS.get(SmtpHelper.class).sendMessage(session, password, mimeMessage);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smtphelper-configuration"><a class="anchor" href="#smtphelper-configuration"></a>SmtpHelper Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>SmtpHelper</code> provides some config properties that allow to modify certain behaviour.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.debugReceiverEmail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If this property is set, the <code>SmtpHelper</code> sends all emails to the specified email address instead of the recipients specified in the <code>MimeMessage</code> object. This is useful for development and testing environments.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mailto:debug-receiver@example.com">debug-receiver@example.com</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.connectionTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the connection timeout for SMTP connections in milliseconds. Default is 60 seconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.readTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the read timeout for SMTP connections in milliseconds. Default is 60 seconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30000</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="connection-pooling-chapter"><a class="anchor" href="#connection-pooling-chapter"></a>Connection Pooling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Normally, the <code>SmtpHelper</code> opens a new connection for every email which is then closed after the email has been sent.
If you want to send a lot of emails, this behaviour is rather inefficient as opening a new SMTP connection takes a long time compared to sending the email especially when using encrypted connections.
To mitigate this overhead, the <code>SmtpHelper</code> supports pooling of SMTP connections which is activated using the <code>poolSize</code> property of <code>SmtpServerConfig</code> objects.
If you set the pool size property to a value &gt; 0, the <code>SmtpHelper</code> will create parallel connections up to the specified number.
This means, that connection pooling is not possible when you use the <code>sendMessage</code> method accepting an already prepared <code>javax.mail.Session</code> object.</p>
</div>
<div class="paragraph">
<p><strong>Pooling</strong> in this context means the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All SMTP server connections sharing the same <code>SmtpServerConfig</code> object (by same meaning being equal according to <code>SmtpServerConfig.equals()</code>) belong to the same pool</p>
</li>
<li>
<p>For each different <code>SmtpServerConfig</code> object (again using <code>SmtpServerConfig.equals()</code>) up to the specified pool size connections are created</p>
</li>
<li>
<p>Connections are not immediately closed after an email has been sent, instead they are returned to the pool as idle connections.</p>
</li>
<li>
<p>Before creating new connections, idle connections are reused.</p>
</li>
<li>
<p>When trying to send an email while all the SMTP connections are currently in use and the pool size has already been reached, the calling thread is blocked until a connection is returned as idle to the pool or as soon as the wait-for-connection-timeout has exceeded.</p>
</li>
<li>
<p>As long as connections are open, a background job monitors their state and closes idle and old connections.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smtpconnectionpool-configuration"><a class="anchor" href="#smtpconnectionpool-configuration"></a>SmtpConnectionPool Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following config properties allow to modify the behavior of the connection pool implementation at the global level:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">key</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.pool.maxIdleTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how long in seconds a connection can be idle before it is closed by the background cleanup job. Default is 60 seconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.pool.maxConnectionLifetime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how long in seconds a connection can be open before it is closed. This is to prevent connections from being open forever when sending emails on a regular basis. Default is 1h.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7200</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scout.smtp.pool.waitForConnectionTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max. wait time for SMTP connection in seconds. If the value is 0, callers will wait infinitely long for SMTP connections. Default is 300 seconds.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="security.html">Security</a></span>
  <span class="next"><a href="observability.html">Observability</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using Antora.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
  </body>
</html>
