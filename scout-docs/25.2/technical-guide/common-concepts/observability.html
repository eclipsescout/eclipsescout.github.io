<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Observability :: Eclipse Scout</title>
    <link rel="prev" href="smtp-helper.html">
    <link rel="next" href="../user-interface/widget.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Eclipse Scout Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search Docs">
      		  <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:scout-docs"> In this project
          </label>
        </div>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="logo" href="https://eclipse.dev/scout/"><img src="../../index.html/../../../_/img/eclipse-scout-logo.svg" alt="Eclipse Scout"></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="scout-docs" data-version="25.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Eclipse Scout</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../getstarted/getstarted.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout.html">Hello Scout Classic</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/run-as-service.html">Build Scout App and Run as Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/run-as-docker-container.html">Run as Docker Container</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/one-day-tutorial.html">One Day Tutorial</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-js.html">Hello Scout JS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-js-fullstack.html">Hello Scout JS Full Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../getstarted/helloscout-cdn.html">Hello Scout JS with a CDN</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../technical-guide.html">Technical Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Common Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="platform.html">Platform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="application.html">Application</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="exception-handling.html">Working with exceptions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="job-manager.html">JobManager</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-context.html">RunContext</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="run-monitor.html">RunMonitor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="smtp-helper.html">SmtpHelper</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="observability.html">Observability</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">User Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/widget.html">Widget</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/object-factory.html">Object Factory</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/form.html">Form</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/form-field.html">Form Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/composite-field.html">Composite Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/group-box.html">Group Box</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/logical-grid.html">Logical Grid</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/value-field.html">Value Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/desktop.html">Desktop</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/outline.html">Outline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/page.html">Page</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/bookmarks.html">Bookmarks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/styling.html">Styling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/mobile.html">Mobile Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/extensibility.html">Extensibility</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/texts.html">Texts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/icons.html">Icons</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/object-identifiers.html">Object Identifiers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/url-hints.html">URL Hints</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/widget-reference.html">Widget Reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/ui-callback.html">UI Callbacks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/ui-preferences.html">UI Preferences</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/html-document-parser.html">HTML Document Parser</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/typescript.html">TypeScript Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/build-stack.html">Build Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../user-interface/browser-support.html">Browser Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Working with Data</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/lookup-call.html">Lookup Call</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/code-type.html">Code Type</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/client-notification.html">Client Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/ui-notifications.html">UI Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/data-object.html">Data Objects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/rest.html">REST</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../working-with-data/jax-ws.html">Webservices with JAX-WS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../sdk/sdk.html">Scout SDK</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sdk/sdk-intellij.html">Scout SDK for IntelliJ</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../sdk/sdk-eclipse.html">Scout SDK for Eclipse</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../howtos/how-tos.html">How-Tos</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/smart-field-how-to.html">SmartField: How to Apply Colors and Styles From a Lookup Row</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-classic/js-form-how-to.html">How to open a Scout JS form in a Scout Classic application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-js/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-js/flip-card-how-to.html">How to Create a Custom Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../howtos/scout-js/rest-service-how-to.html">How to Use a REST Service in Scout JS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../releasenotes/release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../migration/migration-guide.html">Migration Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Eclipse Scout</span>
    <span class="version">25.2</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Eclipse Scout</a>
      <ul class="versions">
        <li class="version">
          <a href="../../../26.1/index.html">26.1</a>
        </li>
        <li class="version is-current is-latest">
          <a href="../../index.html">25.2</a>
        </li>
        <li class="version">
          <a href="../../../25.1/index.html">25.1</a>
        </li>
        <li class="version">
          <a href="../../../24.2/index.html">24.2</a>
        </li>
        <li class="version">
          <a href="../../../24.1/index.html">24.1</a>
        </li>
        <li class="version">
          <a href="../../../23.2/index.html">23.2</a>
        </li>
        <li class="version">
          <a href="../../../23.1/index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../../22/index.html">22</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Eclipse Scout</a></li>
    <li><a href="../technical-guide.html">Technical Guide</a></li>
    <li>Common Concepts</li>
    <li><a href="observability.html">Observability</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">25.2</button>
  <div class="version-menu">
    <a class="version" href="../../../26.1/technical-guide/common-concepts/observability.html">26.1</a>
    <a class="version is-current" href="observability.html">25.2</a>
    <a class="version" href="../../../25.1/technical-guide/common-concepts/observability.html">25.1</a>
    <a class="version" href="../../../24.2/technical-guide/common-concepts/observability.html">24.2</a>
    <a class="version" href="../../../24.1/technical-guide/common-concepts/observability.html">24.1</a>
    <a class="version" href="../../../23.2/technical-guide/common-concepts/observability.html">23.2</a>
    <a class="version" href="../../../23.1/technical-guide/common-concepts/observability.html">23.1</a>
    <a class="version" href="../../../22/technical-guide/common-concepts/observability.html">22</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/eclipse-scout/scout.docs/edit/releases/25.2/docs/modules/technical-guide/pages/common-concepts/observability.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Observability</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Scout supports observability.
The goal is to establish <a href="https://opentelemetry.io/docs/what-is-opentelemetry/">OpenTelemetry</a> as the Observability framework.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="current-state"><a class="anchor" href="#current-state"></a>Current State</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 50%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Signal</th>
<th class="tableblock halign-left valign-top">Support</th>
<th class="tableblock halign-left valign-top">Tested OpenTelemetry Support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Traces</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported, based on OpenTelemetry
disabled by default (see configuration property <code>scout.otel.tracing.enabled</code> and <code>scout.otel.initializerEnabled</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(✅)<br>
currently being tested</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metrics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported, based on OpenTelemetry<br>
disabled by default (see configuration property <code>scout.otel.initializerEnabled</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supported, based on SLF4J</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">❌<br>
no integration in OpenTelemetry yet</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="how-does-it-work"><a class="anchor" href="#how-does-it-work"></a>How Does It Work?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scout uses the features of <a href="https://github.com/open-telemetry/opentelemetry-java/tree/main/sdk-extensions/autoconfigure">OpenTelemetry SDK Autoconfigure</a>,
which allows environment-based configuration of the OpenTelemetry SDK.</p>
</div>
<div class="paragraph">
<p>The main focus is on manual instrumentation provided by the Scout framework.
The OpenTelemetry SDK is initialized by the class <code>org.eclipse.scout.rt.opentelemetry.sdk.OpenTelemetryInitializer</code>.
This initializer will set up the <code>io.opentelemetry.api.GlobalOpenTelemetry</code> instance and some defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exporters: <code>otlp</code> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> for metrics and traces (<code>none</code> for logs due to missing (tested) support)<br>
Protocol: <code>http/protobuf</code></p>
</li>
<li>
<p>Logical service name: Scout&#8217;s <code>ApplicationName</code></p>
</li>
<li>
<p><a href="https://opentelemetry.io/docs/specs/otel/resource/semantic_conventions/#service">Service resource attributes</a>: e.g. <code>service.instance.id</code> (=Scout&#8217;s <code>NodeIdentifier</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
All these defaults can be changed by the corresponding system property or environment variable, see the README of OpenTelemetry SDK Autoconfigure.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="traces-context-propagation"><a class="anchor" href="#traces-context-propagation"></a>Traces: <code>Context</code> Propagation</h3>
<div class="paragraph">
<p>It is important to properly propagate the OpenTelemetry <code>Context</code> between threads in order to correctly relate spans and preserve the hierarchy of the calls.
<code>Context</code> propagation is especially relevant in Scout Applications when calls are made between Scout UI and Scout backend server and within the Scout UI server when we
go from Scout UI Thread to the Scout Model Thread.</p>
</div>
<div class="paragraph">
<p>Overview of the <code>Context</code> propagation:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Notes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenTelemetryFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The parent <code>Context</code> is extracted from the incoming HttpRequest (header). Relevant for both UI and backend to capture incoming calls.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HttpServiceTunnel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>Context</code> is injected into a header of the outgoing HttpRequest. This is a relevant instrumentation to capture calls from UI to backend.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ScoutOpenTelemetryContextStorage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Everytime a new <code>Context</code> is made current, that <code>Context</code> is stored on the RunContext. This ensures proper propagation between UI thread and Model thread.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenTelemetryContextProcessor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensures that the correct <code>Context</code> is propagated between RunContexts.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup-opentelemetry-in-a-scout-application"><a class="anchor" href="#setup-opentelemetry-in-a-scout-application"></a>Setup OpenTelemetry in a Scout Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add the SDK related maven dependencies to the maven module(s), e.g. the <code>.server</code> and <code>.ui.html</code>, according to <a href="#lst-contacts_db_pom">Listing 1</a>.</p>
</div>
<div id="lst-contacts_db_pom" class="listingblock">
<div class="title">Listing 1. The dependencies required in the <code>.server</code> and/or <code>.ui.html</code> pom.xml to use the Scout&#8217;s OpenTelemetry integration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;!-- OpenTelemetry --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.eclipse.scout.rt&lt;/groupId&gt;
      &lt;artifactId&gt;org.eclipse.scout.rt.opentelemetry.sdk&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.opentelemetry&lt;/groupId&gt;
      &lt;artifactId&gt;opentelemetry-exporter-otlp&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The OpenTelemetry&#8217;s <a href="https://opentelemetry.io/docs/instrumentation/java/automatic/">Automatic Instrumentation</a> can be used by disabling the Scout&#8217;s <code>OpenTelemetryInitializer</code>.
by setting the configuration property <code>scout.otel.initializerEnabled</code> to <code>false</code>.
Then you can follow the official setup guide.</p>
</div>
<div class="sect2">
<h3 id="tracing"><a class="anchor" href="#tracing"></a>Tracing</h3>
<div class="paragraph">
<p>Activate tracing by setting the configuration properties <code>scout.otel.initializerEnabled</code> and <code>scout.otel.tracing.enabled</code> to <code>true</code>.
Make sure to include the OpenTelemetryFilter in your setup (e.g by adding it as a IServletFilterContributor or including it in the web.xml).
OpenTelemetryFilter should be placed first.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-it-all-together"><a class="anchor" href="#running-it-all-together"></a>Running It All Together</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Under this <a href="https://github.com/eclipse-scout/scout.docs/tree/releases/25.2/code/org.eclipse.scout.docs.snippets/src/main/docker/observability">link</a> you can find a complete <code>docker compose</code> setup of a demo observability infrastructure.
Follow these steps to run the infrastructure and prepare the application for observability.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../common/_images/observability_sample_setup.drawio.svg" alt="observability sample setup.drawio">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start up the observability infrastructure (for demonstration purposes).<br>
<code>docker compose up</code><br>
To access <code>Grafana</code> go to <a href="http://localhost:3000/" class="bare">http://localhost:3000/</a><br>
(<code>Prometheus</code>: <a href="http://localhost:9090/" class="bare">http://localhost:9090/</a>)</p>
</li>
<li>
<p>Activate OpenTelemetry SDK &amp; OTLP exporter in the application.<br></p>
<div class="ulist">
<ul>
<li>
<p>Configuration property <code>scout.otel.initializerEnabled=true</code></p>
</li>
<li>
<p>Maven dependencies, see <a href="#lst-contacts_db_pom">Listing 1</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Use OTLP exporter in <code>dev</code> mode.<br>
Set configuration property: <code>scout.otel.defaultExporter=otlp</code> or use the system property/environment variables of the autoconfigure feature.</p>
</li>
<li>
<p>Activate OpenTelemetry Tracing support in the application<br></p>
<div class="ulist">
<ul>
<li>
<p>Configuration property <code>scout.otel.tracing.enabled=true</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the <a href="https://opentelemetry.io/docs/languages/java/configuration/#properties-exporters">exporter <code>logging-otlp</code></a> to just print out the observability data.
But do not forget to add the required maven dependency <code>io.opentelemetry:opentelemetry-exporter-logging-otlp</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="providing-custom-metrics"><a class="anchor" href="#providing-custom-metrics"></a>Providing Custom Metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom application metrics can be provided by either put the metric handling directly in the production code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">OpenTelemetry openTelemetry = GlobalOpenTelemetry.get();
// continue with https://opentelemetry.io/docs/instrumentation/java/manual/#metrics.</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by providing an implementation of the interface <code>org.eclipse.scout.rt.platform.opentelemetry.IMetricProvider</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyMetricProvider implements IMetricProvider {

  @Override
  public void register(OpenTelemetry openTelemetry) {
    // continue with https://opentelemetry.io/docs/instrumentation/java/manual/#metrics.
  }

  @Override
  public void close() {
    // noop
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A metric provider is usually used for more generally or feature-independent metrics such as JVM/cpu metrics.
It can also be used for metrics whose source code is not under your control, e.g. external libraries.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is possible to define specific <a href="https://opentelemetry.io/docs/specs/otel/metrics/sdk/#explicit-bucket-histogram-aggregation">explicit bucket distribution</a> for histogram metrics,
see <code>org.eclipse.scout.rt.platform.opentelemetry.IHistogramViewHintProvider</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="providing-custom-samplers"><a class="anchor" href="#providing-custom-samplers"></a>Providing Custom Samplers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ISamplerCustomizerProvider</code> interface allows you to define custom sampling logic based on span attributes. This can help reduce the number of traces sent to the collector by dropping traces that match specific rules.</p>
</div>
<div class="paragraph">
<p>In the example below, two sampling rules are defined. If <strong>either</strong> rule matches (logical OR), the corresponding trace will be dropped. The <strong>first</strong> rule contains two conditions that must both be met (logical AND).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MySamplerProvider implements ISamplerCustomizerProvider {

  @Override
  public Sampler createSamplerCustomizer(Sampler fallback, ConfigProperties config) {
    return new RuleBasedSamplerBuilder(SpanKind.SERVER, fallback)
        .drop(
            EqualityCondition.of(UrlAttributes.URL_QUERY, "poll"),        <i class="conum" data-value="1"></i><b>(1)</b>
            RegexCondition.of(UrlAttributes.URL_PATH, "^/json")           <i class="conum" data-value="2"></i><b>(2)</b>
        )
        .drop(
            RegexCondition.of(UrlAttributes.URL_PATH, "^/status")         <i class="conum" data-value="3"></i><b>(3)</b>
        )
        .build();
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>EqualityCondition</code>: The span attribute value is equals to a target value - in this case "poll"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>RegexCondition</code>: The span attribute value matches a given pattern - in this case "^/json"</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A single condition forming the second rule, matching the pattern <code>^/status</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manual-instrumentation-for-tracing"><a class="anchor" href="#manual-instrumentation-for-tracing"></a>Manual Instrumentation for Tracing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To instrument your own Scout Application see examples for manual instrumentation <a href="https://github.com/open-telemetry/opentelemetry-java-examples?tab=readme-ov-file#java-opentelemetry-examples">here</a></p>
</div>
<div class="paragraph">
<p>When implementing span attributes in your application, exercise caution and ensure that <strong>no customer or user data is included</strong>. This includes personally identifiable information (PII), such as names,
email addresses, user IDs, or any content that could be used to infer what a user was working on within the Scout Application.
Including such data in span attributes can pose <strong>privacy, security, and compliance risks</strong>, and may inadvertently enable <strong>user tracking</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Best Practices</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use only anonymized, non-sensitive metadata in span attributes.</p>
</li>
<li>
<p>Avoid embedding raw user input.</p>
</li>
<li>
<p>If in doubt, consult your security or privacy team before instrumenting data.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. OpenTelemetry Protocol - for more information see <a href="https://opentelemetry.io/docs/specs/otlp/" class="bare">https://opentelemetry.io/docs/specs/otlp/</a>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="smtp-helper.html">SmtpHelper</a></span>
  <span class="next"><a href="../user-interface/widget.html">Widget</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using Antora.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
  </body>
</html>
