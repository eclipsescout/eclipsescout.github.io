<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Eclipse Scout One Day Tutorial :: Eclipse Scout</title>
    <link rel="prev" href="deploy-to-tomcat.html">
    <link rel="next" href="helloscout-js.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Eclipse Scout Docs</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search Docs">
      		  <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:scout-docs"> In this project
          </label>
        </div>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="logo" href="https://www.eclipse.org/scout"><img src="../../23.2/index.html/../../../_/img/eclipse-scout-logo.svg" alt="Eclipse Scout"></a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="scout-docs" data-version="23.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Eclipse Scout</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="getstarted.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="helloscout.html">Hello Scout Classic</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="deploy-to-tomcat.html">Build Scout App and Deploy to Tomcat</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="one-day-tutorial.html">One Day Tutorial</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="helloscout-js.html">Hello Scout JS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="helloscout-js-fullstack.html">Hello Scout JS Full Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="helloscout-cdn.html">Hello Scout JS with a CDN</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../technical-guide/technical-guide.html">Technical Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Common Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/platform.html">Platform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/exception-handling.html">Working with exceptions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/job-manager.html">JobManager</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/run-context.html">RunContext</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/run-monitor.html">RunMonitor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/smtp-helper.html">SmtpHelper</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/common-concepts/observability.html">Observability</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">User Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/widget.html">Widget</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/object-factory.html">Object Factory</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/form.html">Form</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/form-field.html">Form Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/value-field.html">Value Field</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/desktop.html">Desktop</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/styling.html">Styling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/mobile.html">Mobile Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/extensibility.html">Extensibility</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/texts.html">Texts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/icons.html">Icons</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/widget-reference.html">Widget Reference</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/html-document-parser.html">HTML Document Parser</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/typescript.html">TypeScript Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/build-stack.html">Build Stack</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/user-interface/browser-support.html">Browser Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Working with Data</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/lookup-call.html">Lookup Call</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/code-type.html">Code Type</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/client-notification.html">Client Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/data-object.html">Data Objects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/rest.html">REST</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../technical-guide/working-with-data/jax-ws.html">Webservices with JAX-WS</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../sdk/sdk.html">Scout SDK</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sdk/sdk-intellij.html">Scout SDK for IntelliJ</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../sdk/sdk-eclipse.html">Scout SDK for Eclipse</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../howtos/how-tos.html">How-Tos</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/scout-classic/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/scout-classic/smart-field-how-to.html">SmartField: How to Apply Colors and Styles From a Lookup Row</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/scout-classic/js-form-how-to.html">How to open a Scout JS form in a Scout Classic application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scout JS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/scout-js/chart-how-to.html">How to Create a Chart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/scout-js/flip-card-how-to.html">How to Create a Custom Field</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../releasenotes/release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migration/migration-guide.html">Migration Guide</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Eclipse Scout</span>
    <span class="version">23.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../23.2/index.html">Eclipse Scout</a>
      <ul class="versions">
        <li class="version">
          <a href="../../24.1/index.html">24.1</a>
        </li>
        <li class="version is-latest">
          <a href="../../23.2/index.html">23.2</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">23.1</a>
        </li>
        <li class="version">
          <a href="../../22/index.html">22</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../23.2/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Eclipse Scout</a></li>
    <li><a href="getstarted.html">Get Started</a></li>
    <li>Scout Classic</li>
    <li><a href="one-day-tutorial.html">One Day Tutorial</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">23.1</button>
  <div class="version-menu">
    <a class="version" href="../../24.1/getstarted/one-day-tutorial.html">24.1</a>
    <a class="version" href="../../23.2/getstarted/one-day-tutorial.html">23.2</a>
    <a class="version is-current" href="one-day-tutorial.html">23.1</a>
    <a class="version" href="../../22/getstarted/one-day-tutorial.html">22</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/bsi-software/org.eclipse.scout.docs/edit/releases/23.1/docs/modules/getstarted/pages/one-day-tutorial.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Eclipse Scout One Day Tutorial</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This document is referring to a past Scout release. Please click <a href="../../23.2/getstarted/one-day-tutorial.html" class="xref page">here</a> for the recent version.
</td>
</tr>
</table>
</div>
<div id="cha-large_example" class="paragraph">
<p>In this tutorial we will create the &#8220;Contacts&#8221; Scout application.
The goal of this application is to learn about the most prominent features of the Eclipse Scout framework using a fully functional application.</p>
</div>
<div class="paragraph">
<p>The application is kept small enough to complete this tutorial within less than a day.
An extended version of &#8220;Contacts&#8221; is available as a Scout sample application on <a href="https://github.com/bsi-software/org.eclipse.scout.docs/tree/releases/23.1/code/contacts">Github</a>.</p>
</div>
<div class="paragraph">
<p>For this tutorial you can use IntelliJ or Eclipse IDE with installed Scout SDK plugins.
If you have successfully completed the <a href="helloscout.html" class="xref page">Hello Scout Tutorial</a> you should have a running Eclipse Scout installation.
If not, then you should do the Hello Scout Tutorial now.</p>
</div>
<div class="paragraph">
<p>The &#8220;One Day Tutorial&#8221; is organized as follows.
In the first section, the finished &#8220;Contacts&#8221; application is explained from the user perspective.
The remaining sections focus on the individual steps to implement the &#8220;Contacts&#8221; tutorial application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-my_contacts_guide"><a class="anchor" href="#sec-my_contacts_guide"></a>The &#8220;Contacts&#8221; Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The &#8220;Contacts&#8221; demo application is a client server application to manage personal contacts, organizations and events.
The persistence of entered data is achieved via simple JDBC access to a Derby database.</p>
</div>
<div class="paragraph">
<p>It is recommended that you first import the full &#8220;Contacts&#8221; demo application into a separate workspace.
This gives you the possibility to check your source code against the full implementation during the various steps of the tutorial.
To do so, just clone the Scout demo repository and import it into your IDE.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git clone https://github.com/bsi-software/org.eclipse.scout.docs.git</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can also view the source code of the &#8220;Contacts&#8221; demo application on <a href="https://github.com/bsi-software/org.eclipse.scout.docs/tree/releases/23.1/code/contacts">Github</a>.</p>
</div>
<div id="img-app_contacts_personpage" class="imageblock">
<div class="content">
<img src="../common/_images/app_contacts_personpage.png" alt="app contacts personpage">
</div>
<div class="title">Figure 1. The &#8220;Contacts&#8221; application with the person page.</div>
</div>
<div class="paragraph">
<p>The &#8220;Contacts&#8221; application shows the basic user interface layout of a typical Scout application.
The main areas of this layout are briefly introduced below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Outline Button</dt>
<dd>
<p>In <a href="#img-app_contacts_personpage">Figure 1</a> the top left area shows a folder icon that represents the "Contacts" outline.
The small down arrow at the folder icon indicates that additional outlines are available when clicking on this view button.
On the right of the button with the folder icon is a second outline button that activates a search outline (not implemented yet).</p>
</dd>
<dt class="hdlist1">Navigation Tree</dt>
<dd>
<p>The navigation tree on the left side of the layout shows the pages that are available for the selected outline.
For the "Contacts" outline, the navigation tree provides access to the pages "Persons", "Organizations" and "Events".
Selecting a page then shows associated information on the right side in the bench area.
In the case of the selected "Persons" page the bench area shows a list of persons in the form of a table.</p>
</dd>
<dt class="hdlist1">Header</dt>
<dd>
<p>The header area is located at the top and holds the available top level menus.
In this example these are the "Quick access", "Options" menu points as well as a user menu that shows the username of the currently logged in user "mzi".</p>
</dd>
<dt class="hdlist1">Bench</dt>
<dd>
<p>The bench represents the main display area of a Scout application.
When selecting the "Persons" page, a table provides access to all available persons as shown in <a href="#img-app_contacts_personpage">Figure 1</a>.
Selecting a specific person provides access to all actions that are available for the selected person.
The selected person can then be opened with the <em class="menu">Edit</em> menu which opens the person in a view that is displayed in the bench area again as shown in <a href="#img-app_contacts_personform">Figure 2</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For entering and editing of data in Scout applications views are used in most cases.
Views are displayed in the bench area of a Scout application.
Several views can also be opened simultaneously.
To show a specific view the user has to click on the view button associated with the desired view.
An example of an opened view is shown for person "Ver√≥nica" in <a href="#img-app_contacts_personform">Figure 2</a>.</p>
</div>
<div id="img-app_contacts_personform" class="imageblock">
<div class="content">
<img src="../common/_images/app_contacts_personform.png" alt="app contacts personform">
</div>
<div class="title">Figure 2. The &#8220;Contacts&#8221; application with a person opened in a form.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_overview"><a class="anchor" href="#sec-contacts_overview"></a>Tutorial Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial walks you through the implementation of a Scout application consisting of a frontend and a backend application.
The frontend application contains outlines with navigation trees, pages to present information in tabular form, and forms to view and edit data.
In the backend application the tutorial shows how to implement services, logging, database access, and several other aspects of Scout applications.</p>
</div>
<div class="paragraph">
<p>The tutorial is organized as a sequence of consecutive steps as listed below.
Each step is described in a individual section that results in a executable application that can be tested and compared against the full "Contacts" demo application.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Step 1: Setting up the Initial Project (<a href="#sec-contacts_initial_project">Setting up the Initial Project</a>)</dt>
<dd>
<p>We will create a new project and prepare the generated code base by adapting existing components and deleting unnecessary components.
At the end of step one we have a project setup that allows us to start adding new components to the application.</p>
</dd>
<dt class="hdlist1">Step 2: Adding the Person and Organization Page (<a href="#sec-contacts_pages">Adding the Person and Organization Page</a>)</dt>
<dd>
<p>The second step adds the user interface components to display persons and organizations.
For this a "Persons" page and an "Organizations" page are created and added to the "Contacts" outline as shown in <a href="#img-app_contacts_personpage">Figure 1</a>.</p>
</dd>
<dt class="hdlist1">Step 3: Creating and Accessing the Database (<a href="#sec-contacts_jdbc">Creating and Accessing the Database</a>)</dt>
<dd>
<p>This step concentrates on the backend of the "Contacts" application.
The covered topics include dealing with application properties, setup and access of a database and using the database to provide data for the person and organization page created in the previous step.</p>
</dd>
<dt class="hdlist1">Step 4: Adding a Form to Create/Edit Persons (<a href="#sec-contacts_forms">Adding a Form to Create/Edit Persons</a>)</dt>
<dd>
<p>After having access to the database the components that allow a user to create and edit persons and organizations in the user interface of the "Contacts" application can be added.
In addition, this tutorial step also demonstrates how to design and implement complex form layouts with the Scout framework.</p>
</dd>
<dt class="hdlist1">Step 5: Form Field Validation and Template Fields (<a href="#sec-contacts_fields">Form Field Validation and Template Fields</a>)</dt>
<dd>
<p>This step provides an introduction into form field validation and the creation of template fields.
Validation of user input is important for many business applications and template fields help to improve code quality with a mechanism to reuse application specific user interface components.</p>
</dd>
<dt class="hdlist1">Step 6: Adding the Company Form (<a href="#sec-contacts_form_add_company">Adding the Company Form</a>)</dt>
<dd>
<p>We create the organization form to create and enter organizations in the "Contacts" application.
As we can reuse many of the components developed so far this is the shortest tutorial step.</p>
</dd>
<dt class="hdlist1">Step 7: Linking Organizations and Persons (<a href="#sec-contacts_link_organization_person">Linking Organizations and Persons</a>)</dt>
<dd>
<p>In this step we modify the user interface to implement a 1:n relationship between organizations and persons.
This includes the creation of a hierarchical page structure for organization, adding an organization column to the person page and adding an organization field to the person form to manage the association of a person to an organization.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_initial_project"><a class="anchor" href="#sec-contacts_initial_project"></a>Setting up the Initial Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section deals with setting up the initial workspace and code base for the "Contacts" application.
The creation up of the initial project setup consists of the tasks listed below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating the initial Codebase (<a href="#sec-contacts_initial_codebase">Creating the initial Codebase</a>)</p>
</li>
<li>
<p>Removing unnecessary Components (<a href="#sec-contacts_remove_stuff">Removing unnecessary Components</a>)</p>
</li>
<li>
<p>Changes to Class WorkOutline (<a href="#sec-contacts_change_workoutline">Changes to Class WorkOutline</a>)</p>
</li>
<li>
<p>Changes to Class Desktop (<a href="#sec-contacts_change_desktop">Changes to Class Desktop</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This first step of the "Contacts" tutorial ends with a review of the results of this first tutorial step in <a href="#sec-contacts_summary">What have we achieved?</a>.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_initial_codebase"><a class="anchor" href="#sec-contacts_initial_codebase"></a>Creating the initial Codebase</h3>
<div class="paragraph">
<p>If you are using Eclipse and your workspace contains modules from the &#8220;Hello World&#8221; tutorial, you may want to multi-select them and to either close them by invoking the context menu &#8220;Close Projects&#8221; or to delete them by invoking the context menu &#8220;Delete&#8221;.
The initial code for the &#8220;Contacts&#8221; application is then generated using the <em class="wizard">New Scout Project</em> wizard.
For the wizard fields you may use the values below and as shown in <a href="#img-sdk_new_project_tutorial_Intellij">Figure 3</a> (IntelliJ) and <a href="#img-sdk_new_project_tutorial">Figure 4</a> (Eclipse).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em class="field">Group Id</em>: <code>org.eclipse.scout</code></p>
</li>
<li>
<p><em class="field">Artifact Id</em>: <code>contacts</code></p>
</li>
<li>
<p><em class="field">Display Name</em>: "Contacts Application"</p>
</li>
</ul>
</div>
<div id="img-sdk_new_project_tutorial_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_project_tutorial_Intellij.png" alt="sdk new project tutorial Intellij">
</div>
<div class="title">Figure 3. The creation of the initial "Contacts" application in IntelliJ.</div>
</div>
<div id="img-sdk_new_project_tutorial" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_project_tutorial.png" alt="sdk new project tutorial">
</div>
<div class="title">Figure 4. The creation of the initial "Contacts" application in Eclipse.</div>
</div>
<div class="paragraph">
<p>To create this initial application click on <b class="button">Next/Finish</b>.
The project wizard then creates a number of Maven modules as shown in <a href="#img-contacts_package_explorer_Intellij">Figure 5</a> (IntelliJ) and <a href="#img-contacts_package_explorer">Figure 6</a> (Eclipse).</p>
</div>
<div id="img-contacts_package_explorer_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/app_contacts_package_explorer_initial_Intellij.png" alt="app contacts package explorer initial Intellij">
</div>
<div class="title">Figure 5. The package explorer with the initial Maven modules created for the "Contacts" application in IntelliJ.</div>
</div>
<div id="img-contacts_package_explorer" class="imageblock">
<div class="content">
<img src="../common/_images/app_contacts_package_explorer_initial.png" alt="app contacts package explorer initial">
</div>
<div class="title">Figure 6. The package explorer with the initial Maven modules created for the "Contacts" application in Eclipse.</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_remove_stuff"><a class="anchor" href="#sec-contacts_remove_stuff"></a>Removing unnecessary Components</h3>
<div class="paragraph">
<p>We start with removing the <code>*.helloworld</code> and <code>\*.settings</code> packages in all Maven modules of the "Contacts" application.
To delete packages, first select an individual package or packages in the package explorer as shown in <a href="#img-contacts_package_explorer">Figure 6</a> (IntelliJ) and <a href="#img-contacts_package_explorer">Figure 6</a> (Eclipse) and then hit the <kbd>Delete</kbd> key.</p>
</div>
<div class="paragraph">
<p>The packages to delete is provided per Maven module in the list below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Client Module <code>contacts.client</code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>In folder <code>src/main/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.client.helloworld</code></p>
</li>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.client.settings</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>In folder <code>src/test/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.client.helloworld</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Server Module <code>contacts.server</code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>In folder <code>src/main/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.server.helloworld</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>In folder <code>src/test/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.server.helloworld</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Shared Module <code>contacts.shared</code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>In folder <code>src/main/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.shared.helloworld</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>In folder <code>src/generated/java</code></p>
<div class="ulist">
<ul>
<li>
<p>Delete package <code>org.eclipse.scout.contacts.shared.helloworld</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The deletion of these outlines results in a number of compile errors in classes <code>WorkOutline</code> and <code>Desktop</code>.
All these errors will be resolved in the following two sections where we modify the two classes to our needs.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_change_workoutline"><a class="anchor" href="#sec-contacts_change_workoutline"></a>Changes to Class WorkOutline</h3>
<div class="paragraph">
<p>Instead of adding a new "Contacts" outline to the application we reuse the generated code and rename the "Work" outline into "Contacts" outline.
For this, we perform the following modifications to class <code>WorkOutline</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename the class package to <code>org.eclipse.scout.contacts.client.contact</code></p>
</li>
<li>
<p>Rename the class to <code>ContactOutline</code></p>
</li>
<li>
<p>Change the outline title to "Contacts"</p>
</li>
<li>
<p>Change the outline icon to <code>Icons.Folder</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To quickly find the class <code>WorkOutline</code> we first open the <em class="wizard">Open Type</em> dialog by hitting <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>N</kbd></span> in IntelliJ or <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>T</kbd></span> in Eclipse and enter "workoutline" into the search field as shown in <a href="#img-eclipse_open_type_Intellij">Figure 7</a> (IntelliJ) and <a href="#img-eclipse_open_type">Figure 8</a> (Eclipse).
In the result list, we select the desired class and click the <b class="button">OK</b> button to open the file <code>WorkOutline.java</code> in the Java editor of your IDE.</p>
</div>
<div id="img-eclipse_open_type_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/eclipse_open_type_Intellij.png" alt="eclipse open type Intellij">
</div>
<div class="title">Figure 7. Use the Open Type dialog to quickly find java types in IntelliJ.</div>
</div>
<div id="img-eclipse_open_type" class="imageblock">
<div class="content">
<img src="../common/_images/eclipse_open_type.png" alt="eclipse open type">
</div>
<div class="title">Figure 8. Use the Open Type dialog to quickly find java types in Eclipse.</div>
</div>
<div class="paragraph">
<p>We start with the package rename.
To rename the package <code>org.eclipse.scout.contacts.client.work</code> to <code>org.eclipse.scout.contacts.client.contact</code> click into the word "work" of the package name and hit <span class="keyseq"><kbd>Shift</kbd>+<kbd>F6</kbd></span> (Eclipse: <span class="keyseq"><kbd>Alt</kbd>+<kbd>Shift</kbd>+<kbd>R</kbd></span>).
This opens the package rename dialog as shown in <a href="#img-sdk_rename_package_Intellij">Figure 9</a> (IntelliJ) and <a href="#img-sdk_rename_package">Figure 10</a> (Eclipse), where we replace "work" by "contact" in the <em class="element">New name</em> field.
After pressing the <b class="button">Ok</b> button your IDE informs the programmer that the code modification may not be accurate as the resource has compile errors.
This warning can be acknowledged by clicking <b class="button">Continue</b>.</p>
</div>
<div id="img-sdk_rename_package_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_rename_package_Intellij.png" alt="sdk rename package Intellij">
</div>
<div class="title">Figure 9. Use the IntelliJ Rename Package dialog to rename a Java package in IntelliJ.</div>
</div>
<div id="img-sdk_rename_package" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_rename_package.png" alt="sdk rename package">
</div>
<div class="title">Figure 10. Use the Eclipse Rename Package dialog to rename a Java package in Eclipse.</div>
</div>
<div class="paragraph">
<p>In next step we rename class <code>WorkOutline</code> to <code>ContactOutline</code>.
In the Java editor we can rename the class by clicking into the class identifier <code>WorkOutline</code> and hitting <span class="keyseq"><kbd>Shift</kbd>+<kbd>F6</kbd></span> (Eclipse: <span class="keyseq"><kbd>Alt</kbd>+<kbd>Shift</kbd>+<kbd>R</kbd></span>).
Inside the edit box we can then change the class name to <code>ContactOutline</code> and hit the <kbd>Enter</kbd> key to execute the change.
If your IDE shows a Rename Type dialog just hit button <b class="button">Continue</b> to complete the rename operation.
To get rid of the compile error in method <code>execCreateChildPages</code> we simply delete the content in the method body.</p>
</div>
<div class="paragraph">
<p>Next, we change the outline title in method <code>getConfiguredTitle</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace the string "Work" with "Contacts".</p>
</li>
<li>
<p>Set the cursor at the end of the word "Contacts" and hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span>.</p>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Double-click on the proposal <em class="element">New text&#8230;&#8203;</em> to open the Scout new entry wizard as shown in <a href="#img-sdk_new_text_entry_contact">Figure 12</a> and  <a href="#img-sdk_new_text_entry_contact_wizard">Figure 13</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enter the text "Contacts" as shown in <a href="#img-sdk_new_text_entry_contact_wizard_IntelliJ">Figure 11</a> (IntelliJ) and <a href="#img-sdk_new_text_entry_contact_wizard">Figure 13</a> (Eclipse) and click <b class="button">Ok</b>.</p>
</li>
</ol>
</div>
<div id="img-sdk_new_text_entry_contact_wizard_IntelliJ" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_text_entry_contact_wizard_IntelliJ.png" alt="sdk new text entry contact wizard IntelliJ">
</div>
<div class="title">Figure 11. Use the Scout new entry wizard to add translated texts to the application in IntelliJ.</div>
</div>
<div id="img-sdk_new_text_entry_contact" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_text_entry_contact.png" alt="sdk new text entry contact">
</div>
<div class="title">Figure 12. Use the Scout content assist to add new translations.</div>
</div>
<div id="img-sdk_new_text_entry_contact_wizard" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_text_entry_contact_wizard.png" alt="sdk new text entry contact wizard">
</div>
<div class="title">Figure 13. Use the Scout new entry wizard to add translated texts to the application in Eclipse.</div>
</div>
<div class="paragraph">
<p>As the last modification we change the return value of method <code>getConfiguredIconId</code> to value <code>Icons.Folder</code> and end with the code shown in <a href="#lst-contacts_outline">Listing 1</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In IntelliJ, the import for the Icons class should be added automatically. If not, check your settings for auto import or use <code>Alt enter</code> to import it manually.<br>
In Eclipse, you can use <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>O</kbd></span> to add the imports manually.
</td>
</tr>
</table>
</div>
<div id="lst-contacts_outline" class="listingblock">
<div class="title">Listing 1. Initial implementation of class ContactOutline.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("303c0267-3c99-4736-a7f5-3097c5e011b6")
public class ContactOutline extends AbstractOutline {

  @Override
  protected void execCreateChildPages(List&lt;IPage&lt;?&gt;&gt; pageList) {
  }

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("Contacts");
  }

  @Override
  protected String getConfiguredIconId() {
    return Icons.Folder;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_change_desktop"><a class="anchor" href="#sec-contacts_change_desktop"></a>Changes to Class Desktop</h3>
<div class="paragraph">
<p>The second class to adapt for the "Contacts" application is the <code>Desktop</code> class.
This class is implemented exactly once in each Scout application and holds the available outlines and top level menus of the application in the form of inner classes.</p>
</div>
<div class="paragraph">
<p>For the "Contacts" application we adapt the initial implementation to have outline view buttons for the "Contacts" and "Search" outlines.
The top level menus are then adapted to hold the menus "Quick Access", "Options" and a menu for the logged in user.</p>
</div>
<div class="paragraph">
<p>Start with opening the class in the Java editor using <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>N</kbd></span> (Eclipse: <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>T</kbd></span>) to quickly access the class.
In the source code of method <code>getConfiguredOutlines</code> remove <code>SettingsOutline.class</code> from the list of return values as shown in <a href="#lst-contacts_getConfiguredOutlines">Listing 2</a>.</p>
</div>
<div id="lst-contacts_getConfiguredOutlines" class="listingblock">
<div class="title">Listing 2. Method getConfiguredOutlines defines the outlines associated with the desktop of the application.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Override
  protected List&lt;Class&lt;? extends IOutline&gt;&gt; getConfiguredOutlines() {
    return CollectionUtility.&lt;Class&lt;? extends IOutline&gt;&gt; arrayList(ContactOutline.class, SearchOutline.class);
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, perform the following changes in class <code>Desktop</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete the inner class <code>SettingOutlineViewButton</code></p>
</li>
<li>
<p>Delete the inner class <code>UserProfileMenu</code>.</p>
</li>
<li>
<p>Rename inner class WorkOutlineViewButton to <code>ContactOutlineViewButton</code></p>
</li>
<li>
<p>Create a new inner class called <code>QuickAccessMenu</code> after the <code>SearchOutlineViewButton</code>.
For this navigate the cursor after the <code>SearchOutlineViewButton</code> class, press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> and select the <code>Menu</code> entry.
Adapt the created code until it matches the template as shown in <a href="#lst-contacts_desktop">Listing 3</a>.
Note that in your implementation, the menu should extend <code>AbstractMenu</code> instead of <code>AbstractFormMenu</code> in contrast to what is shown in <a href="#lst-contacts_desktop">Listing 3</a>.
As a consequence, the method <code>getConfiguredForm</code> from <a href="#lst-contacts_desktop">Listing 3</a> is obsolete.</p>
</li>
<li>
<p>Create another menu called <code>OptionsMenu</code> right after the newly created <code>QuickAccessMenu</code> according to <a href="#lst-contacts_desktop">Listing 3</a>.</p>
</li>
<li>
<p>Create a last menu called <code>UserMenu</code> after the <code>OptionsMenu</code> according to <a href="#lst-contacts_desktop">Listing 3</a>.</p>
</li>
<li>
<p>Delete the method <code>onThemeChanged</code>.</p>
</li>
<li>
<p>Remove the statement in the body of the constructor.</p>
</li>
<li>
<p>Note that it is not necessary to organize the imports since you have registered the organization of imports as a save action earlier in this tutorial.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the end of these changes the inner class structure of class Desktop will look similar to the sample shown in <a href="#lst-contacts_desktop">Listing 3</a>.</p>
</div>
<div id="lst-contacts_desktop" class="listingblock">
<div class="title">Listing 3. Structure of class Desktop with outline buttons and top level menus.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("70eda4c8-5aed-4e61-85b4-6098edad8416")
public class Desktop extends AbstractDesktop {

  // outline buttons of the application
  @Order(1)
  @ClassId("9405937b-66e8-491a-831d-69adca724b90")
  public class ContactOutlineViewButton extends AbstractOutlineViewButton {
  }

  @Order(2)
  @ClassId("55febc84-ad6d-4ee8-9963-d1d40169a63a")
  public class SearchOutlineViewButton extends AbstractOutlineViewButton {
  }

  // top level menus for the header area of the application
  @Order(10)
  @ClassId("50df7a9d-dd3c-40a3-abc4-4619eff8d841")
  public class QuickAccessMenu extends AbstractMenu {

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("QuickAccess");
    }

  }

  @Order(20)
  @ClassId("4fce42bf-85f9-4892-96a2-2e89e18eeaee")
  public class OptionsMenu extends AbstractFormMenu&lt;OptionsForm&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("Options");
    }

    @Override
    protected String getConfiguredIconId() {
      return Icons.Gear;
    }

    @Override
    protected Class&lt;OptionsForm&gt; getConfiguredForm() {
      return OptionsForm.class;
    }

  }

  @Order(30)
  @ClassId("8dbfbe9d-0382-471a-ae43-3178f7a9e720")
  public class UserMenu extends AbstractFormMenu&lt;UserForm&gt; { <i class="conum" data-value="2"></i><b>(2)</b>

    @Override
    protected String getConfiguredIconId() {
      return Icons.PersonSolid;
    }

    @Override
    protected String getConfiguredCssClass() {
      return "profile-menu";
    }

    @Override
    protected Class&lt;UserForm&gt; getConfiguredForm() {
      return UserForm.class;
    }

  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In your implementation <code>OptionsMenu</code> should extend <code>AbstractMenu</code> and the method <code>getConfiguredForm</code> should be deleted.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In your implementation <code>UserMenu</code> should extend <code>AbstractMenu</code> and the method <code>getConfiguredForm</code> should be deleted.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_summary"><a class="anchor" href="#sec-contacts_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the first step of the "Contacts" tutorial we have created the initial project setup that will serve as the basis for all the following tutorial steps.</p>
</div>
<div class="paragraph">
<p>As the "Contacts" application is in a clean state you can now test the application using the following steps.
The user interface of the application will now look as shown in <a href="#img-contacts_tutorial_result_step_1">Figure 14</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Activate the launch group <em>[webapp] all</em> to start the JS build, the frontend and the backend</p>
</li>
<li>
<p>Open address <a href="http://localhost:8082/">http://localhost:8082/</a> in your browser</p>
</li>
</ul>
</div>
<div id="img-contacts_tutorial_result_step_1" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_1.png" alt="contacts tutorial result step 1">
</div>
<div class="title">Figure 14. The "Contacts" application at the end of tutorial step 1.</div>
</div>
<div class="paragraph">
<p>From the coding perspective we now have all necessary maven Modules for the "Contacts" application including Java package and class names to match with the complete Scout "Contacts" demo application.
This point is important as it simplifies the comparison of intermediate stages of the tutorial application with the Scout demo application.
The same is true for the user perspective: The layout of the current state of the tutorial matches with the complete "Contacts" sample application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_pages"><a class="anchor" href="#sec-contacts_pages"></a>Adding the Person and Organization Page</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the second step of the Scout tutorial the components to display persons and organizations are added to the "Contacts" outline of the user interface of the Scout application.
Specifically, a "Persons" page and an "Organizations" page are created and added to the navigation tree of the "Contacts" outline.</p>
</div>
<div class="paragraph">
<p>Database access and populating the pages with actual data from the database is not part of this section but will be covered in the next tutorial step (<a href="#sec-contacts_jdbc">Creating and Accessing the Database</a>).</p>
</div>
<div class="paragraph">
<p>The addition of the "Persons" page is described in detail in the sections listed below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating additional Packages (<a href="#sec-contacts_creating_person_package">Creating additional Packages</a>)</p>
</li>
<li>
<p>Creating the Country Lookup Call (<a href="#sec-contacts_country_lookup_call">Creating the Country Lookup Call</a>)</p>
</li>
<li>
<p>Creating the Person Page (<a href="#sec-contacts_creating_person_page">Creating the Person Page</a>)</p>
</li>
<li>
<p>Adding Table Columns to the Page (<a href="#sec-contacts_adding_page_columns">Adding Table Columns to the Page</a>)</p>
</li>
<li>
<p>Link the Person Page to the Contacts Outline (<a href="#sec-contacts_link_person_page">Link the Person Page to the Contacts Outline</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The addition of the company page is described in <a href="#sec-contacts_adding_company_page">Adding the Company Page</a>.
Finally, the state of the "Contacts" application is summarized in <a href="#sec-contacts_summary_step_2">What have we achieved?</a>.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_creating_person_package"><a class="anchor" href="#sec-contacts_creating_person_package"></a>Creating additional Packages</h3>
<div class="paragraph">
<p>A substantial part of the "Contacts" application deals with persons.
In addition to the "Persons" page we will also add a Scout form to enter/edit persons in a later tutorial step.
For the "Contacts" application we use this fact to justify the addition of a specific Java package that will hold all classes related to persons.
This person package can be created with the following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the "Contacts" Maven module <code>contacts.client</code> in the Eclipse Package Explorer</p>
</li>
<li>
<p>Select the Java package <code>org.eclipse.scout.contacts.client</code> in folder <code>src/main/java</code></p>
</li>
<li>
<p>For IntelliJ:</p>
<div class="ulist">
<ul>
<li>
<p>Create a package by right-clicking on the Java package and selecting <code>New &#8594; Package</code> as shown in <a href="#img-contacts_person_package_Intellij">Figure 15</a></p>
</li>
<li>
<p>Enter <code>org.eclipse.scout.contacts.client.person</code> and press <em class="button">Enter</em> as shown in <a href="#img-contacts_person_package_wizard_Intellij">Figure 16</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Press <kbd>Ctrl</kbd>+<kbd>N</kbd>, enter "package" into the search field and select the <em class="wizard">Package</em> wizard in the proposal box and click <em class="button">Next</em></p>
</li>
<li>
<p>Press <em class="button">Finish</em> as shown in <a href="#img-contacts_person_package">Figure 17</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="img-contacts_person_package_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_package_Intellij.png" alt="sdk new package Intellij">
</div>
<div class="title">Figure 15. Create the person package in IntelliJ.</div>
</div>
<div id="img-contacts_person_package_wizard_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_package_wizard_Intellij.png" alt="sdk new package wizard Intellij">
</div>
<div class="title">Figure 16. Add the person package to the "Contacts" application in IntelliJ.</div>
</div>
<div id="img-contacts_person_package" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_package_wizard.png" alt="sdk new package wizard">
</div>
<div class="title">Figure 17. Add the person package to the "Contacts" application in Eclipse.</div>
</div>
<div class="paragraph">
<p>We will also need a separate package for organizations and some common elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add package <code>org.eclipse.scout.contacts.client.organization</code></p>
</li>
<li>
<p>Add package <code>org.eclipse.scout.contacts.client.common</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_country_lookup_call"><a class="anchor" href="#sec-contacts_country_lookup_call"></a>Creating the Country Lookup Call</h3>
<div class="paragraph">
<p>The pages for the persons and the organizations will also display country information.
To display country names we will be using a special column, that maps the country codes received from the backend application to translated country names.
As the Java class <code>Locale</code> already contains both country codes and country names we can take advantage of this class and use it in a Scout local lookup call.</p>
</div>
<div class="paragraph">
<p>In package <code>org.eclipse.scout.contacts.client.common</code> create a new class <code>CountryLookupCall</code> according to the implementation provided in <a href="#lst-contacts_country_lookup">Listing 4</a>.</p>
</div>
<div id="lst-contacts_country_lookup" class="listingblock">
<div class="title">Listing 4. The Scout lookup call for countries. This lookup call will be used for the address field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("37736ea5-e861-43d8-a6bc-144dad3c208f")
public class CountryLookupCall extends LocalLookupCall&lt;String&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

  private static final long serialVersionUID = 1L;

  @Override
  protected List&lt;LookupRow&lt;String&gt;&gt; execCreateLookupRows() { <i class="conum" data-value="2"></i><b>(2)</b>
    List&lt;LookupRow&lt;String&gt;&gt; rows = new ArrayList&lt;&gt;();

    for (String countryCode : Locale.getISOCountries()) {
      Locale country = new Locale("", countryCode);
      rows.add(new LookupRow&lt;&gt;(countryCode, country.getDisplayCountry())); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    return rows;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Makes the <code>CountryLookupCall</code> to work with key type <code>String</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Defines the set of lookup rows to be used</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add a row with the country code as key and the country name as display value</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_creating_person_page"><a class="anchor" href="#sec-contacts_creating_person_page"></a>Creating the Person Page</h3>
<div class="paragraph">
<p>In this section we create the Scout page that will be used to list all entered persons to the user of the "Contacts" application.
Out-of-the box this page will support the sorting and filtering of all the persons.
This "Persons" page is then added to the navigation tree below the "Contacts" outline.</p>
</div>
<div class="paragraph">
<p>We can now add the Scout person page as described below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the newly created package <code>org.eclipse.scout.contacts.client.person</code> in the Package Explorer</p>
</li>
<li>
<p>For IntelliJ</p>
<div class="ulist">
<ul>
<li>
<p>Create a new Scout page by right-clicking on the package and selecting <code>New &#8594; Scout Element &#8594; Page</code> as shown in <a href="#img-contacts_create_new_person_page_Intellij">Figure 18</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse</p>
<div class="ulist">
<ul>
<li>
<p>Press <kbd>Ctrl</kbd>+<kbd>N</kbd>, enter "scout page" into the search field and select the <em class="wizard">Scout Page</em> wizard in the proposal box and click [button].</p>
</li>
<li>
<p>Un-check the <em>Create an Abstract Super Page</em> option, as we don&#8217;t need an additional abstract super class for our new page.</p>
</li>
<li>
<p>Enter <code>PersonTablePage</code> as the class name and click <em class="button">Finish</em> as shown in <a href="#img-contacts_new_person_page">Figure 20</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="img-contacts_create_new_person_page_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_create_new_personpage_wizard_Intellij.png" alt="sdk create new personpage wizard Intellij">
</div>
<div class="title">Figure 18. Create the person page in IntelliJ.</div>
</div>
<div id="img-contacts_new_person_page_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_personpage_wizard_Intellij.png" alt="sdk new personpage wizard Intellij">
</div>
<div class="title">Figure 19. Add the person page to the "Contacts" application in IntelliJ.</div>
</div>
<div id="img-contacts_new_person_page" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_personpage_wizard.png" alt="sdk new personpage wizard">
</div>
<div class="title">Figure 20. Add the person page to the "Contacts" application in Eclipse.</div>
</div>
<div class="paragraph">
<p>The Scout <em class="wizard">New Page Wizard</em> then creates an initial implementation for the <code>PersonTablePage</code> class very similar to the listing provided in <a href="#lst-contacts_PersonTable">Listing 5</a> below.</p>
</div>
<div id="lst-contacts_PersonTable" class="listingblock">
<div class="title">Listing 5. Initial implementation of class PersonTablePage.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PageData(PersonTablePageData.class)
@ClassId("23c10251-66b1-4bd6-a9d7-93c7d1aedede")
public class PersonTablePage extends AbstractPageWithTable&lt;Table&gt; {

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("Persons"); <i class="conum" data-value="1"></i><b>(1)</b>
  }

  @Override
  protected void execLoadData(SearchFilter filter) {
    importPageData(BEANS.get(IPersonService.class)
        .getPersonTableData(filter, getOrganizationId())); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  @Override <i class="conum" data-value="3"></i><b>(3)</b>
  protected boolean getConfiguredLeaf() {
    return true;
  }

  @ClassId("3fa1374b-9635-441b-b2f8-feb24b50740a")
  public class Table extends AbstractTable {
    // container class to hold columns and other elements for this table page <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before we start to add the columns to the table of the page we need to do some minor adaptations to <a href="#lst-contacts_PersonTable">Listing 5</a>.</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Specify the title "Persons" for the page using the Scout NLS tooling.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You don&#8217;t need to update method <code>execLoadData</code> to match this listing for now.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Add method <code>getConfiguredLeaf</code> to specify that the person page will not have any child pages.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We will add the columns in the next section of this tutorial.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We are now ready to populate the inner class <code>Table</code> of the person page with the columns to display various person attributes.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_adding_page_columns"><a class="anchor" href="#sec-contacts_adding_page_columns"></a>Adding Table Columns to the Page</h3>
<div class="paragraph">
<p>Table pages are an important UI element of Scout applications as they frequently play a central role in the interactions of a user with the application.
Out of the box table pages offer powerful options to sort, filter and re-arrange the data contained in the table.
This functionality offers a good starting point to decide which columns to add to a table page.</p>
</div>
<div class="paragraph">
<p>To decide about the columns to add the following criteria have been useful in practice.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unique identifier of an element</p>
</li>
<li>
<p>Attributes that are most frequently used in searches</p>
</li>
<li>
<p>Category attributes that are useful for filtering</p>
</li>
<li>
<p>Fewer columns are better</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As the visible data of all users is held in the memory of the frontend server it is good practice to keep the number of columns as low as possible.
Not taking this advice into account can substantially increase the memory footprint of the frontend server in production.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the person page of the "Contacts" application we will add the following columns.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PersonId</strong>: Hidden attribute of type string to hold the person key. Class name: <code>PersonIdColumn</code></p>
</li>
<li>
<p><strong>First Name</strong>: String column. Class name: <code>FirstNameColumn</code></p>
</li>
<li>
<p><strong>Last Name</strong> String column. Class name: <code>LastNameColumn</code></p>
</li>
<li>
<p><strong>City</strong>: String column. Class name: <code>CityColumn</code></p>
</li>
<li>
<p><strong>Country</strong>: Smart column. Class name: <code>CountryColumn</code></p>
</li>
<li>
<p><strong>Phone</strong>: String column, not visible per default. Class name: <code>PhoneColumn</code></p>
</li>
<li>
<p><strong>Mobile Phone</strong>: String column, not visible per default. Class name: <code>MobileColumn</code></p>
</li>
<li>
<p><strong>Email</strong>: String column, not visible per default. Class name: <code>EmailColumn</code></p>
</li>
<li>
<p><strong>Organization</strong>: String column, not visible per default. Class name: <code>OrganizationColumn</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Make sure to use column class names exactly as indicated above.
Working with different names is possible but requires additional work later in the tutorial when the data retrieved from the database is mapped to these column class names.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To add the first column <code>PersonIdColumn</code> we open class <code>PersonTablePage</code> in the Java editor and place the cursor inside of the body of the inner <code>Table</code> class.
We then open the Scout content assist with <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> and select the <em class="element">Column</em> proposal as shown in <a href="#img-sdk_new_page_column_contacts_IntelliJ">Figure 21</a> (IntelliJ) and <a href="#img-sdk_new_page_column_contacts">Figure 22</a> (Eclipse).</p>
</div>
<div id="img-sdk_new_page_column_contacts_IntelliJ" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_page_column_contacts_IntelliJ.png" alt="sdk new page column contacts IntelliJ">
</div>
<div class="title">Figure 21. Adding a column to the person page table in IntelliJ.</div>
</div>
<div id="img-sdk_new_page_column_contacts" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_page_column_contacts.png" alt="sdk new page column contacts">
</div>
<div class="title">Figure 22. Adding a column to the person page table in Eclipse.</div>
</div>
<div class="paragraph">
<p>In the first edit box we type "PersonId" as shown in <a href="#img-sdk_new_page_column_personid_Intellij">Figure 23</a> (IntelliJ) and <a href="#img-sdk_new_page_column_personid">Figure 24</a> (Eclipse) and press <kbd>Enter</kbd>.</p>
</div>
<div id="img-sdk_new_page_column_personid_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_page_column_personid_Intellij.png" alt="sdk new page column personid Intellij">
</div>
<div class="title">Figure 23. Adding a column to the person page table in IntelliJ.</div>
</div>
<div id="img-sdk_new_page_column_personid" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_page_column_personid.png" alt="sdk new page column personid">
</div>
<div class="title">Figure 24. Adding a column to the person page table in Eclipse.</div>
</div>
<div class="paragraph">
<p>To configure this column as an invisible primary key we modify the newly created column class according to <a href="#lst-contacts_PersonIdColumn">Listing 6</a>.</p>
</div>
<div id="lst-contacts_PersonIdColumn" class="listingblock">
<div class="title">Listing 6. Implementation of the person primary key column PersonIdColumn.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @Order(1)
    @ClassId("1cbc9059-caef-4684-b013-bfa3bc0d0642")
    public class PersonIdColumn extends AbstractStringColumn {

      @Override <i class="conum" data-value="1"></i><b>(1)</b>
      protected boolean getConfiguredDisplayable() {
        return false;
      }

      @Override <i class="conum" data-value="2"></i><b>(2)</b>
      protected boolean getConfiguredPrimaryKey() {
        return true;
      }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Returning <code>false</code> here makes this column invisible. As this column will be excluded from the table control the user is not aware of the existence of this column.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Returning <code>true</code> marks this attibute as a primary key (or part of a primary key)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can now add the additional columns <code>FirstNameColumn</code>, <code>LastNameColumn</code>, <code>CityColumn</code> below.
After entering the class name press <kbd>Tab</kbd> twice to move the cursor to the label text of the field.
In the case of the first name enter "FirstName" and hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> to open the wizard to add the translated text "First Name".</p>
</div>
<div class="paragraph">
<p>For these three columns the default implementation is fine and does not need any adaptations.
<a href="#lst-contacts_FirstNameColumn">Listing 7</a> below provides an example for this type of columns.</p>
</div>
<div id="lst-contacts_FirstNameColumn" class="listingblock">
<div class="title">Listing 7. Implementation of the first name column.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @Order(2)
    @ClassId("99df594a-6731-4757-a799-aacdbb4788d3")
    public class FirstNameColumn extends AbstractStringColumn {

      @Override
      protected String getConfiguredHeaderText() {
        return TEXTS.get("FirstName");
      }

      @Override
      protected int getConfiguredWidth() {
        return 120;
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>For column <code>CountryColumn</code> we will use a smart column.
We again use <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> to open the wizard and enter "Country" for the class name box and press <kbd>Tab</kbd> once and select <em class="element">AbstractSmartColumn</em> as column type.
Next we press <kbd>Tab</kbd> again to enter "Country" as the translated text.</p>
</div>
<div class="paragraph">
<p>In the created class <code>CountryColumn</code> we need to add the generic type parameter to the super class declaration (<code>AbstractSmartColumn&lt;String&gt;</code>) and add the method <code>getConfiguredLookupCall</code> according to <a href="#lst-contacts_CountryColumn">Listing 8</a>.</p>
</div>
<div id="lst-contacts_CountryColumn" class="listingblock">
<div class="title">Listing 8. Implementation of the country smart column.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @Order(5)
    @ClassId("a39ad408-b5e5-4794-b86a-ddc13025862e")
    public class CountryColumn extends AbstractSmartColumn&lt;String&gt; {

      @Override
      protected String getConfiguredHeaderText() {
        return TEXTS.get("Country");
      }

      @Override
      protected int getConfiguredWidth() {
        return 120;
      }

      @Override <i class="conum" data-value="1"></i><b>(1)</b>
      protected Class&lt;? extends ILookupCall&lt;String&gt;&gt; getConfiguredLookupCall() {
        return CountryLookupCall.class;
      }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The configured lookup call is used to map country codes to the country names used in the user interface.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After the country column we add the four columns <code>PhoneColumn</code>, <code>MobileColumn</code>, <code>EmailColumn</code> and <code>OrganizationColumn</code> that are initially not visible in the user interface.
As an example for such a column <a href="#lst-contacts_PhoneColumn">Listing 9</a> is provided below.</p>
</div>
<div id="lst-contacts_PhoneColumn" class="listingblock">
<div class="title">Listing 9. Implementation of the (initially invisible) phone column.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @Order(6)
    @ClassId("fa879506-d38c-46a6-990c-1f1ae4b74d4e")
    public class PhoneColumn extends AbstractStringColumn {

      @Override
      protected String getConfiguredHeaderText() {
        return TEXTS.get("Phone");
      }

      @Override <i class="conum" data-value="1"></i><b>(1)</b>
      protected boolean getConfiguredVisible() {
        return false;
      }

      @Override
      protected int getConfiguredWidth() {
        return 120;
      }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Returning <code>false</code> hides the column initially. Using the table control the user can then make this column visible in the user interface.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the content assist to efficiently add method <code>getConfiguredVisible</code>.
Place the cursor after method <code>getConfiguredHeaderText</code>, type "getConVis" and hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> and the method is inserted for you.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We have now created a person page with corresponding table columns.
However, this new UI component is not yet visible in the user interface.
What is missing is the link from the application&#8217;s contacts outline class to the newly created <code>PersonTablePage</code> class.
This is what we will do in the following section.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_link_person_page"><a class="anchor" href="#sec-contacts_link_person_page"></a>Link the Person Page to the Contacts Outline</h3>
<div class="paragraph">
<p>In this section we add the person page to the contacts outline created during the initial project setup of the first step of this tutorial.
This will make the person page visible in the navigation area below the "Contacts" outline.</p>
</div>
<div class="paragraph">
<p>For this we have to add a single line of code to method <code>execCreateChildPages</code> of class <code>ContactOutline</code> according to <a href="#lst-contacts_add_person_page">Listing 10</a></p>
</div>
<div id="lst-contacts_add_person_page" class="listingblock">
<div class="title">Listing 10. Adding the PersonTable to the ContactOutline.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Override
  protected void execCreateChildPages(List&lt;IPage&lt;?&gt;&gt; pageList) {
    // pages to be shown in the navigation area of this outline
    pageList.add(new PersonTablePage()); <i class="conum" data-value="1"></i><b>(1)</b>
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A new instance of the <code>PersonTable</code> is added to this outline. This makes the person page visible in the navigation area below the contacts outline.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The application is now in a state where we can restart the backend and the frontend server to verify our changes in the user interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_adding_company_page"><a class="anchor" href="#sec-contacts_adding_company_page"></a>Adding the Company Page</h3>
<div class="paragraph">
<p>This section creates and adds a table page for organization to the "Contacts" outline.
To create an organizations page the same steps are required as for the creation of the person page.
The description is therefore kept on a higher level and in the text below only the main steps are described.
Where appropriate, pointers are provided to the detailed descriptions for the creation of the person page.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add page <code>OrganizationTablePage</code> with title "Organizations" using the Scout new page wizard</p>
</li>
</ul>
</div>
<div id="lst-contacts_OrganizationTablePage" class="listingblock">
<div class="title">Listing 11. Initial implementation of class OrganizationTablePage.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PageData(OrganizationTablePageData.class)
@ClassId("18f7a78e-0dd0-4e4e-9234-99892bb4459f")
public class OrganizationTablePage extends AbstractPageWithTable&lt;Table&gt; {

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("Organizations"); <i class="conum" data-value="1"></i><b>(1)</b>
  }

  @Override
  protected void execLoadData(SearchFilter filter) {
    importPageData(BEANS.get(IOrganizationService.class).getOrganizationTableData(filter));
  }

  @ClassId("54f3d730-7a62-462b-99ec-78fd1e6bb69d")
  public class Table extends AbstractTable {
    // container class to hold columns and other elements for this table page
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Make sure to add a translated text entry for "Organizations" using the Scout NLS tooling</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The implementation of class <code>OrganizationTablePage</code> using the Scout new page wizard then looks as shown in <a href="#lst-contacts_OrganizationTablePage">Listing 11</a>.</p>
</div>
<div class="paragraph">
<p>As in the case of the person page you can now add the columns for the inner <code>Table</code> class.
For the organization page add the columns according to the specification provided below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OrganizationId</strong>: Hidden attribute of type string to hold the organization key. Class name: <code>OrganizationIdColumn</code></p>
</li>
<li>
<p><strong>Name</strong>: String column. Class name: <code>NameColumn</code></p>
</li>
<li>
<p><strong>City</strong>: String column. Class name: <code>CityColumn</code></p>
</li>
<li>
<p><strong>Country</strong>: Smart column. Class name: <code>CountryColumn</code></p>
</li>
<li>
<p><strong>Homepage</strong>: String column, not visible per default. Class name: <code>HomepageColumn</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As in the case of the person page we have to add the newly created class <code>OrganizationTablePage</code> in method <code>execCreateChildPages</code> of the outline class <code>ContactOutline</code> as shown in <a href="#lst-contacts_add_organization_page">Listing 12</a>.</p>
</div>
<div id="lst-contacts_add_organization_page" class="listingblock">
<div class="title">Listing 12. Adding the OrganizationTablePage to the ContactOutline.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Override
  protected void execCreateChildPages(List&lt;IPage&lt;?&gt;&gt; pageList) {
    // pages to be shown in the navigation area of this outline
    pageList.add(new PersonTablePage()); <i class="conum" data-value="1"></i><b>(1)</b>
    pageList.add(new OrganizationTablePage());
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The pages will appear in the user interface according to the order in which they are added to the outline.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_summary_step_2"><a class="anchor" href="#sec-contacts_summary_step_2"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the second step of the "Contacts" tutorial we have created a person page and an organization page to display data of persons and organizations.</p>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the user interface in your browser.
The user interface should look like the screenshot provided in <a href="#img-contacts_tutorial_result_step_2">Figure 25</a>.</p>
</div>
<div id="img-contacts_tutorial_result_step_2" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_2.png" alt="contacts tutorial result step 2">
</div>
<div class="title">Figure 25. The "Contacts" application with the person and organization pages at the end of tutorial step 2.</div>
</div>
<div class="paragraph">
<p>When comparing the state of the "Contacts" tutorial application with the Scout demo application in <a href="#img-app_contacts_personpage">Figure 1</a> the main difference is the missing person data.
Adding access to a database is the focus of the next tutorial step.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_jdbc"><a class="anchor" href="#sec-contacts_jdbc"></a>Creating and Accessing the Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial step shows how Scout applications can interact with databases via JDBC.
Due to the clean layering implemented in the "Contacts" application only the Scout backend server connects to the database.
We therefore focus on the Scout backend in this part of the tutorial.</p>
</div>
<div class="paragraph">
<p>For the "Contacts" application we will work with a <a href="https://db.apache.org/derby/index.html">Derby database</a>.
The choice of Derby is based on the fact that no additional installation is required and it is possible to work with in-memory databases.</p>
</div>
<div class="paragraph">
<p>We start this tutorial step with copying the classes that handle the database creation/access from the full "Contacts" demo application as described in <a href="#sec-contacts_jdbc_infra">Adding the Infrastructure</a>.
The setup is then explained in the following sections.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Scout Config Properties (<a href="#sec-contacts_jdbc_properties">Scout Config Properties</a>)</p>
</li>
<li>
<p>The SQL Service and SQL Statements (<a href="#sec-contacts_jdbc_sql">The SQL Service and SQL Statements</a>)</p>
</li>
<li>
<p>The Database Setup Service (<a href="#sec-contacts_jdbc_initial_db">The Database Setup Service</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With the basic infrastructure in place we review the existing "Contacts" backend to answer the question <a href="#sec-contacts_jdbc_starting">What is missing?</a>.
In <a href="#sec-contacts_jdbc_fetching_data">Fetching Organization and Person Data</a> we then add the missing pieces.</p>
</div>
<div class="paragraph">
<p>At the end of this tutorial step the "Contacts" backend server provides person and organization data to the frontend server as summarized in <a href="#sec-contacts_jdbc_summary">What have we achieved?</a>.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_infra"><a class="anchor" href="#sec-contacts_jdbc_infra"></a>Adding the Infrastructure</h3>
<div class="paragraph">
<p>This section describes the installation of the necessary components and classes that handle the database creation/access of the "Contacts" application.</p>
</div>
<div class="paragraph">
<p>To add the support for the Scout JDBC components and the Derby database we first need to declare the corresponding dependencies in the pom.xml file of the Maven server module.
This can be done using the following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expanding the Maven module <code>contacts.server</code> in the Eclipse Package Explorer</p>
</li>
<li>
<p>Open the <code>pom.xml</code> file (use a double click on the file in the package explorer) and switch to the "pom.xml" tab in the Maven POM Editor.</p>
</li>
<li>
<p>Add the database related dependencies according to <a href="#lst-contacts_db_pom">Listing 13</a></p>
</li>
</ul>
</div>
<div id="lst-contacts_db_pom" class="listingblock">
<div class="title">Listing 13. The additional dependencies needed in the server pom.xml to use the derby database</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;parent&gt;
    &lt;groupId&gt;org.eclipse.scout.contacts&lt;/groupId&gt;
    &lt;artifactId&gt;org.eclipse.scout.contacts&lt;/artifactId&gt;
    &lt;version&gt;23.1-SNAPSHOT&lt;/version&gt;
    &lt;relativePath&gt;../org.eclipse.scout.contacts&lt;/relativePath&gt;
  &lt;/parent&gt;

  &lt;artifactId&gt;org.eclipse.scout.contacts.server&lt;/artifactId&gt;

  &lt;dependencies&gt;
    &lt;!-- database related dependencies --&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;dependency&gt;
      &lt;groupId&gt;org.eclipse.scout.rt&lt;/groupId&gt;
      &lt;artifactId&gt;org.eclipse.scout.rt.server.jdbc&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;
      &lt;artifactId&gt;derby&lt;/artifactId&gt;
      &lt;version&gt;10.15.2.0&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.derby&lt;/groupId&gt;
      &lt;artifactId&gt;derbytools&lt;/artifactId&gt;
      &lt;version&gt;10.15.2.0&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the <code>derby</code> and the <code>org.eclipse.scout.rt.server.jdbc</code> dependencies to the pom.xml of your "Contacts" server module.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After adding the database dependencies to the server&#8217;s pom.xml file we need to update all Maven server modules for the "Contacts" app.
To do this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For IntelliJ, press the Maven button on the right side as shown in <a href="#img-contacts_tutorial_maven_modules_Intellij">Figure 26</a> to open up the Maven modules and then press the refresh button on the left side as shown in <a href="#img-contacts_tutorial_update_server_modules_Intellij">Figure 27</a>.</p>
</li>
<li>
<p>For Eclipse, select the three modules <code>org.eclipse.scout.contacts.server.*</code> and hit <span class="keyseq"><kbd>Alt</kbd>+<kbd>F5</kbd></span> as shown in <a href="#img-contacts_tutorial_update_server_modules">Figure 28</a> and start the update with <b class="button">OK</b>.</p>
</li>
</ul>
</div>
<div id="img-contacts_tutorial_maven_modules_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_maven_modules_Intellij.png" alt="contacts tutorial maven modules Intellij">
</div>
<div class="title">Figure 26. Locate the Maven server modules in IntelliJ.</div>
</div>
<div id="img-contacts_tutorial_update_server_modules_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_update_server_modules_Intellij.png" alt="contacts tutorial update server modules Intellij">
</div>
<div class="title">Figure 27. Update the Maven server modules for the "Contacts" application in IntelliJ.</div>
</div>
<div id="img-contacts_tutorial_update_server_modules" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_update_server_modules.png" alt="contacts tutorial update server modules">
</div>
<div class="title">Figure 28. Update the Maven server modules for the "Contacts" application in Eclipse.</div>
</div>
<div class="paragraph">
<p>The next step is to create the <code>org.eclipse.scout.contacts.server.sql</code> package.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expand folder <code>src/main/java</code> of Maven module <code>contacts.server</code></p>
</li>
<li>
<p>Select the existing package <code>org.eclipse.scout.contacts.server</code></p>
</li>
<li>
<p>For IntelliJ:</p>
<div class="ulist">
<ul>
<li>
<p>Right click on it and select <code>New &#8594; Package</code></p>
</li>
<li>
<p>Enter <code>org.eclipse.scout.contacts.server.sql</code> into the <em class="field">Name</em> field and hit <kbd>Enter</kbd></p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>N</kbd></span> on it</p>
</li>
<li>
<p>This opens the dialog to select a wizard. Enter "package" into the search field</p>
</li>
<li>
<p>Select the <em class="wizard">New Java Package</em> wizard with a double click on the Java <em class="element">Package</em> proposal</p>
</li>
<li>
<p>Enter <code>org.eclipse.scout.contacts.server.sql</code> into the <em class="field">Name</em> field of the wizard and click <b class="button">Finish</b></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>We are now ready to copy the classes related to the database infrastructure from the "Contacts" demo application to our tutorial workspace.</p>
</div>
<div class="paragraph">
<p>The simplest way to do this is to open a second Eclipse IDE with the workspace where you have imported the Scout demo applications.
If you have not done this yet go to the beginning of this tutorial <a href="#cha-large_example">[cha-large_example]</a> and catch up now.</p>
</div>
<div class="paragraph">
<p>In the demo application workspace navigate to the same package <code>org.eclipse.scout.contacts.server.sql</code> and copy over all its classes.
After copying these classes make sure that the structure of your server Maven module looks as shown in <a href="#img-contacts_tutorial_copied_db_classes_intellij">Figure 29</a> (IntelliJ) and <a href="#img-contacts_tutorial_copied_db_classes">Figure 30</a> (Eclipse).</p>
</div>
<div id="img-contacts_tutorial_copied_db_classes_intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_copied_db_classes_intellij.png" alt="contacts tutorial copied db classes intellij">
</div>
<div class="title">Figure 29. The copied database classes in the tutorial workspace in IntelliJ.</div>
</div>
<div id="img-contacts_tutorial_copied_db_classes" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_copied_db_classes.png" alt="contacts tutorial copied db classes">
</div>
<div class="title">Figure 30. The copied database classes in the tutorial workspace in Eclipse.</div>
</div>
<div class="paragraph">
<p>The imported classes are described in the following sections.
Additional information is provided where these classes are relying on Scout concepts that have not previously been introduced.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_properties"><a class="anchor" href="#sec-contacts_jdbc_properties"></a>Scout Config Properties</h3>
<div class="paragraph">
<p>Scout Config properties can greatly improve the flexibility of Scout applications.
For the "Contacts" application this feature is used to keep its database setup configurable.
Moving from a in-memory setup to a disk based database is then possible without any reprogramming.</p>
</div>
<div class="paragraph">
<p>The Scout backend (and frontend) applications initialize config properties from matching values found in file <code>config.properties</code>.
For missing property values the default values defined in the config property classes are used.</p>
</div>
<div class="paragraph">
<p>In the case of the "Contacts" application the config property files are located in the subfolder <code>src/main/resources</code> of the Maven modules that specify the frontend and the backend application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expand Maven module <code>contacts.server.app.dev</code></p>
</li>
<li>
<p>Expand subfolder <code>src/main/resources</code></p>
</li>
<li>
<p>Open file <code>config.properties</code> in the text editor</p>
</li>
<li>
<p>Append all properties defined in <a href="#lst-contacts_database_props">Listing 14</a> to the file</p>
</li>
</ul>
</div>
<div id="lst-contacts_database_props" class="listingblock">
<div class="title">Listing 14. Properties relevant for creating and accessing the database.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">### Database
contacts.database.jdbc.mappingName=jdbc:derby:memory:contacts-database
contacts.database.autocreate=true
contacts.database.autopopulate=true

### Application specific
contacts.superuser=system</code></pre>
</div>
</div>
<div class="paragraph">
<p>These added property values then match the config properties defined in the class <code>DatabaseProperties</code> provided in <a href="#lst-contacts_props">Listing 15</a>.
Remember that this is one of the database infrastructure classes we have copied before.</p>
</div>
<div id="lst-contacts_props" class="listingblock">
<div class="title">Listing 15. Typed properties for the "Contacts" application</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class DatabaseProperties {

  public static class DatabaseAutoCreateProperty extends AbstractBooleanConfigProperty {
    // defines default value and key

    @Override
    public Boolean getDefaultValue() {
      return Boolean.TRUE; <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @Override
    public String getKey() {
      return "contacts.database.autocreate"; <i class="conum" data-value="2"></i><b>(2)</b>
    }

    @Override
    public String description() {
      return "Specifies if the contacts database should automatically be created if it does not exist yet. The default value is true.";
    }
  }

  public static class DatabaseAutoPopulateProperty extends AbstractBooleanConfigProperty {
    // defines default value and key
  }

  public static class JdbcMappingNameProperty extends AbstractStringConfigProperty {
    // defines default value and key
  }

  public static class SuperUserSubjectProperty extends AbstractSubjectConfigProperty {
    // defines default value and key
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Defines the default value of the property that is used if the property is not defined in file config.properties</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Defines the key to be used in file config.properties</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the Scout framework config properties are always typed and need to implement interface <code>IConfigProperty</code>.
For commonly used types Scout already provides classes.
A boolean property may be created by extending Scout class <code>AbstractBooleanConfigProperty</code>.</p>
</div>
<div class="paragraph">
<p>Accessing the actual property values in the code is demonstrated in the next section.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_sql"><a class="anchor" href="#sec-contacts_jdbc_sql"></a>The SQL Service and SQL Statements</h3>
<div class="paragraph">
<p>Accessing databases with the Scout framework is implemented with SQL services that extend base class <code>AbstractSqlService</code>.
As the "Contacts" application will be working with a Derby database we also need a Derby specific SQL service.</p>
</div>
<div class="paragraph">
<p>This is why we have copied over class <code>DerbySqlService</code>.
The only project specific method is <code>getConfiguredJdbcMappingName</code> as implemented in <a href="#lst-contacts_derby_service">Listing 16</a>.</p>
</div>
<div id="lst-contacts_derby_service" class="listingblock">
<div class="title">Listing 16. The Derby SQL service to connect to the database</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class DerbySqlService extends AbstractDerbySqlService {

  @Override
  protected String getConfiguredJdbcMappingName() {
    return CONFIG.getPropertyValue(JdbcMappingNameProperty.class);
  }

  public void createDB() {
    String mappingName = CONFIG.getPropertyValue(JdbcMappingNameProperty.class);
    try {
      runDerbyCommand(mappingName + ";create=true"); <i class="conum" data-value="1"></i><b>(1)</b>
    }
    catch (SQLException e) {
      throw BEANS.get(PlatformExceptionTranslator.class).translate(e);
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Check the <a href="https://db.apache.org/derby/docs/10.11/ref/rrefattrib24612.html">Derby documentation</a> for additional attributes.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This listing also demonstrates how to use the config properties in the code.
With the property values defined in the previous section the "Contacts" application is working with an in-memory database.</p>
</div>
<div class="paragraph">
<p>To change the setup to a disk based version, we would have to change the value for the property <code>contacts.database.jdbc.mappingName</code>
from <code>jdbc:derby:memory:contacts-database</code> to <code>jdbc:derby:&lt;path-to-dir&gt;</code>.
For a Windows box a concrete example could look like this: <code>jdbc:derby:c:\\derby\\contacts-database</code>.</p>
</div>
<div class="paragraph">
<p>Now we look at how the actual SQL statements of the "Contacts" application work.
For our application all statements are collected into a single class.
While there are many more options how to organize SQL and Java code this setup has its own advantages.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Efficient maintenance as all SQL statements are located in a single place</p>
</li>
<li>
<p>Code completion support in the Eclipse IDE when using the statements</p>
</li>
<li>
<p>The setup is easy to explain</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SQL statements related to the database structure are provided in <a href="#lst-contacts_sql_createdb">Listing 17</a>.
The statements (or building blocks of statements) in interface <code>SQLs</code> are plain SQL in many cases.
In the other cases the statement texts include Scout specific syntax extensions with <code>:</code> as a prefix character.
Examples are <code>:&lt;identifier&gt;</code> and <code>:{&lt;identifier&gt;.&lt;attribute&gt;}</code>.</p>
</div>
<div id="lst-contacts_sql_createdb" class="listingblock">
<div class="title">Listing 17. Interface SQLs with the SQL commands for the creation of the database tables.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface SQLs {

  String SELECT_TABLE_NAMES = ""
      + "SELECT   UPPER(tablename) "
      + "FROM     sys.systables "
      + "INTO     :result"; <i class="conum" data-value="1"></i><b>(1)</b>

  String ORGANIZATION_CREATE_TABLE = ""
      + "CREATE   TABLE ORGANIZATION "
      + "         (organization_id VARCHAR(64) NOT NULL CONSTRAINT ORGANIZATION_PK PRIMARY KEY,"
      + "          name VARCHAR(64), "
      + "          logo_url VARCHAR(512), "
      + "          url VARCHAR(64), "
      + "          street VARCHAR(64), "
      + "          city VARCHAR(64), "
      + "          country VARCHAR(2), "
      + "          phone VARCHAR(20), "
      + "          email VARCHAR(64), "
      + "          notes VARCHAR(1024)"
      + "         )";

  String PERSON_CREATE_TABLE = ""
      + "CREATE   TABLE PERSON "
      + "         (person_id VARCHAR(64) NOT NULL CONSTRAINT PERSON_PK PRIMARY KEY, "
      + "          first_name VARCHAR(64), "
      + "          last_name VARCHAR(64), "
      + "          picture_url VARCHAR(512), "
      + "          date_of_birth DATE, "
      + "          gender VARCHAR(1), "
      + "          street VARCHAR(64), "
      + "          city VARCHAR(64), "
      + "          country VARCHAR(2), "
      + "          phone VARCHAR(20), "
      + "          mobile VARCHAR(20), "
      + "          email VARCHAR(64), "
      + "          organization_id VARCHAR(64), "
      + "          position VARCHAR(512), "
      + "          phone_work VARCHAR(20), "
      + "          email_work VARCHAR(64), "
      + "          notes VARCHAR(1024), "
      + "          CONSTRAINT ORGANIZATION_FK FOREIGN KEY (organization_id) REFERENCES ORGANIZATION (organization_id)"
      + "         )";
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The syntax ':identifier' adds convenience and is supported by the Scout framework</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next section discusses how the components introduced above are used by the "Contacts" appliction to create an initial "Contacts" database during the startup phase of the application.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_initial_db"><a class="anchor" href="#sec-contacts_jdbc_initial_db"></a>The Database Setup Service</h3>
<div class="paragraph">
<p>The database setup service is responsible to create the "Contacts" database during the startup of the application.
In order to implement such a service, a number of Scout concepts are combined into class <code>DatabaseSetupService</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access config properties using class <code>CONFIG</code></p>
</li>
<li>
<p>Executing SQL statements via class <code>SQL</code></p>
</li>
<li>
<p>Logging via class <code>LOG</code></p>
</li>
<li>
<p>Scout platform with the annotations <code>@ApplicationScoped</code>, <code>@CreateImmediately</code> and <code>@PostConstruct</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>How these elements are used in class <code>DatabaseSetupService</code> is shown in <a href="#lst-contacts_dbsetup_service">Listing 18</a>.
The actual creation of the "Contacts" database is performed by the method <code>autoCreateDatabase</code>.</p>
</div>
<div class="paragraph">
<p>At the time of the database creation no user is yet logged into the application.
This is why we use a run context associated with the super user.
The context is then used to execute the runnable that creates the organization and person tables.</p>
</div>
<div id="lst-contacts_dbsetup_service" class="listingblock">
<div class="title">Listing 18. Class DatabaseSetupService to create the database tables for the "Contacts" application.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@CreateImmediately
public class DatabaseSetupService implements IDataStoreService {
  private static final Logger LOG = LoggerFactory.getLogger(DatabaseSetupService.class);

  @PostConstruct
  public void autoCreateDatabase() {
    if (CONFIG.getPropertyValue(DatabaseAutoCreateProperty.class)) {
      try {
        BEANS.get(DerbySqlService.class).createDB();
        RunContext context = BEANS.get(SuperUserRunContextProducer.class).produce();
        IRunnable runnable = () -&gt; {
          createOrganizationTable();
          createPersonTable();
        };

        context.run(runnable);
      }
      catch (RuntimeException e) {
        BEANS.get(ExceptionHandler.class).handle(e);
      }
    }
  }

  public void createOrganizationTable() {
    if (!getExistingTables().contains("ORGANIZATION")) {
      SQL.insert(SQLs.ORGANIZATION_CREATE_TABLE);
      LOG.info("Database table 'ORGANIZATION' created");

      if (CONFIG.getPropertyValue(DatabaseAutoPopulateProperty.class)) {
        SQL.insert(SQLs.ORGANIZATION_INSERT_SAMPLE + SQLs.ORGANIZATION_VALUES_01);
        SQL.insert(SQLs.ORGANIZATION_INSERT_SAMPLE + SQLs.ORGANIZATION_VALUES_02);
        LOG.info("Database table 'ORGANIZATION' populated with sample data");
      }
    }
  }

  public void createPersonTable() {
    if (!getExistingTables().contains("PERSON")) {
      SQL.insert(SQLs.PERSON_CREATE_TABLE);
      LOG.info("Database table 'PERSON' created");

      if (CONFIG.getPropertyValue(DatabaseAutoPopulateProperty.class)) {
        SQL.insert(SQLs.PERSON_INSERT_SAMPLE + SQLs.PERSON_VALUES_01);
        SQL.insert(SQLs.PERSON_INSERT_SAMPLE + SQLs.PERSON_VALUES_02);
        LOG.info("Database table 'PERSON' populated with sample data");
      }
    }
  }

  private Set&lt;String&gt; getExistingTables() {
    StringArrayHolder tables = new StringArrayHolder();
    SQL.selectInto(SQLs.SELECT_TABLE_NAMES, new NVPair("result", tables)); <i class="conum" data-value="1"></i><b>(1)</b>
    return CollectionUtility.hashSet(tables.getValue());
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The existing tables are stored in the <code>StringArrayHolder</code> object named "result".</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The usage of <code>CONFIG</code> is already covered by the previous section.
Introductions for <code>SQL</code>, <code>LOG</code> and the Scout platform annotations are provided below.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Logging</dt>
<dd>
<p>Scout uses the <a href="http://www.slf4j.org/manual.html">SLF4J</a> framework for logging.
For the actual implementation of the loggers Scout uses <a href="http://logback.qos.ch/">Logback</a> per default.
To use logging a local logger is first created using the SLF4J <code>LoggerFactory</code> class.
Additional information regarding the logging configuration is provided below.</p>
</dd>
<dt class="hdlist1">Executing SQL Statements</dt>
<dd>
<p>For the execution of SQL statements Scout provides the convenience class <code>SQL</code>.
The various methods can be used with a simple SQL command as in <code>SQL.insert(mySqlCommand)</code> or using additional named objects as in <code>SQL.insertInto(mySqlCommand, myHolder)</code>.
The Scout class <code>NVPair</code> is frequently used to create such named objects.
Make sure that the identifiers (using the Scout <code>:</code> syntax) provided in the SQL commands always match with the names associated with the named objects.</p>
</dd>
<dt class="hdlist1">Scout Platform</dt>
<dd>
<p>The Scout platform provides the basic infrastructure and a number of services to a Scout application.
Services are represented by Scout beans that are registered at startup with the platform and created once they are needed.
For class <code>DatabaseSetupService</code> we can use the Scout annotation <code>@ApplicationScoped</code> to register the service and to make sure that there will only be a single instance of this class.
To force the creation of a bean <code>DatabaseSetupService</code> at startup time we also add Scout annotation <code>@CreateImmediately</code>.
Finally, the annotation <code>@PostConstruct</code> executes our method <code>autoCreateDatabase</code> as soon as the <code>DatabaseSetupService</code> bean is created.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Changing the basic log level of an application is a frequently used scenario.
As Scout is using Logback per default we can adapt the log level in the <code>logback.xml</code> configuration files as shown in <a href="#lst-contacts_logback_loglevel">Listing 19</a>.
For the "Contacts" application these configuration files are located in folder <code>src/main/resources</code> of the Maven modules that define the frontend and the backend applications.
More information regarding these configuration files is provided in the <a href="http://logback.qos.ch/manual/configuration.html">Logback manual</a>.</p>
</div>
<div id="lst-contacts_logback_loglevel" class="listingblock">
<div class="title">Listing 19. Setting the log level in the logback.xml configuration file.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;configuration&gt;
  &lt;root level="INFO"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;appender-ref ref="STDOUT" /&gt;
    &lt;appender-ref ref="STDERR" /&gt;
  &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>level</code> attribute of the <code>&lt;root&gt;</code> element is used as the basic log level. Try "DEBUG" or "WARN" as alternative values.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_starting"><a class="anchor" href="#sec-contacts_jdbc_starting"></a>What is missing?</h3>
<div class="paragraph">
<p>This section reviews the backend infrastructure that has been created so far and identifies the pieces that are missing to fetch person and organization data to send it to the frontend server of the "Contacts" application.</p>
</div>
<div class="paragraph">
<p>During the creation of the person page and the organization page the Scout wizards created more than just Scout pages that are visible in the user interface.
It also added corresponding classes in the shared module and the server module of the "Contacts" application.</p>
</div>
<div class="paragraph">
<p>The new page wizard basically added the complete round trip from the client (frontend server) to the server (backend server) and back.
Using the organization page as an example, the setup created by the page wizard involves the following classes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <code>OrganizationTablePage</code> with method <code>execLoadData</code> in the client module</p>
</li>
<li>
<p>The service interface <code>IOrganizationService</code> and class <code>OrganizationTablePageData</code> in the shared module</p>
</li>
<li>
<p>Class <code>OrganizationService</code> with the method stub <code>getOrganizationTableData</code> in the server module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the client side the server roundtrip is implemented in method <code>execLoadData</code> as shown in <a href="#lst-contacts_organization_page_loaddata">Listing 20</a>.</p>
</div>
<div id="lst-contacts_organization_page_loaddata" class="listingblock">
<div class="title">Listing 20. Accessing the "Contacts" backend server to fetch organization data.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Override
  protected void execLoadData(SearchFilter filter) {
    importPageData(BEANS.get(IOrganizationService.class).getOrganizationTableData(filter));
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This roundtrip between class <code>OrganizationTablePage</code> and <code>OrganizationService</code> works through the following steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>BEANS.get(IOrganizationService.class)</code> returns a reference to a client proxy service</p>
</li>
<li>
<p>Method <code>getOrganizationTableData(filter)</code> is executed on the corresponding server service</p>
</li>
<li>
<p>This method returns the organization data in the form of an <code>OrganizationTablePageData</code> object</p>
</li>
<li>
<p>Method <code>importPageData</code> transfers the data from the page data into the table of the user interface</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On the server side fetching the data from the database will be implemented in class <code>OrganizationService</code> according to <a href="#lst-contacts_organization_page_getdata">Listing 21</a>.</p>
</div>
<div id="lst-contacts_organization_page_getdata" class="listingblock">
<div class="title">Listing 21. Method getTableData to access the database and map the data into a pageData object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class OrganizationService implements IOrganizationService {

  @Override
  public OrganizationTablePageData getOrganizationTableData(SearchFilter filter) {
    OrganizationTablePageData pageData = new OrganizationTablePageData();
    return pageData;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the next section we will implement the database access logic in the <code>getOrganizationTableData</code> methods of the server classes <code>OrganizationService</code> and <code>PersonService</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_fetching_data"><a class="anchor" href="#sec-contacts_jdbc_fetching_data"></a>Fetching Organization and Person Data</h3>
<div class="paragraph">
<p>We are now ready to fetch data from the Derby database using the available infrastructure and the SQL statements prepared in class <code>SQLs</code>.
For the implementation of method <code>getOrganizationTableData</code> in class <code>OrganizationService</code> we will use the two SQL snippets provided in <a href="#lst-contacts_sql_list_org">Listing 22</a>.</p>
</div>
<div id="lst-contacts_sql_list_org" class="listingblock">
<div class="title">Listing 22. Interface SQLs with the SQL to fetch the list of organizations with their attributes.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface SQLs {
  String ORGANIZATION_PAGE_SELECT = ""
      + "SELECT   organization_id, "
      + "         name, "
      + "         city, "
      + "         country, "
      + "         url "
      + "FROM     ORGANIZATION ";

  String ORGANIZATION_PAGE_DATA_SELECT_INTO = ""
      + "INTO     :{page.organizationId}, " <i class="conum" data-value="1"></i><b>(1)</b>
      + "         :{page.name}, "
      + "         :{page.city}, "
      + "         :{page.country}, "
      + "         :{page.homepage}";
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The syntax ':{identifier.attribute}' adds convenience to map SQL result sets to Scout page data objects.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Taking advantage of the SQL convenience offered by the Scout framework, we can add the missing functionality with two lines of code.
See <a href="#lst-contacts_fetch_orgs">Listing 23</a> for the full listing of method <code>getOrganizationTableData</code>.
After adding the two additional lines, we update the imports of the classes with pressing <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>O</kbd></span>.</p>
</div>
<div id="lst-contacts_fetch_orgs" class="listingblock">
<div class="title">Listing 23. Method getTableData to access the database and map the data into a pageData object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class OrganizationService implements IOrganizationService {

  @Override
  public OrganizationTablePageData getOrganizationTableData(SearchFilter filter) {
    OrganizationTablePageData pageData = new OrganizationTablePageData();

    String sql = SQLs.ORGANIZATION_PAGE_SELECT + SQLs.ORGANIZATION_PAGE_DATA_SELECT_INTO; <i class="conum" data-value="1"></i><b>(1)</b>
    SQL.selectInto(sql, new NVPair("page", pageData)); <i class="conum" data-value="2"></i><b>(2)</b>

    return pageData;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Added line 1: Assembling of the SQL statement</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Added line 2: Fetching the data from the database and storing the result in <code>pageData</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that the identifier "page" in the NVPair object will be mapped to the same identifier used in the <code>ORGANIZATION_PAGE_DATA_SELECT_INTO</code> statement.</p>
</div>
<div class="paragraph">
<p>Finally, we have to also implement the loading of the person data in class <code>PersonService</code>.
The implementation of method <code>getPersonTableData</code> is provided in <a href="#lst-contacts_fetch_pers">Listing 24</a>.</p>
</div>
<div id="lst-contacts_fetch_pers" class="listingblock">
<div class="title">Listing 24. Method getPersonTableData to access the database and map the data into a page data object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonService implements IPersonService {

  @Override
  public PersonTablePageData getPersonTableData(SearchFilter filter) {
    PersonTablePageData pageData = new PersonTablePageData();

    String sql = SQLs.PERSON_PAGE_SELECT + SQLs.PERSON_PAGE_DATA_SELECT_INTO;
    SQL.selectInto(sql, new NVPair("page", pageData));

    return pageData;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_jdbc_summary"><a class="anchor" href="#sec-contacts_jdbc_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the third step of the "Contacts" tutorial we have added the infrastructure to work with a Derby database.
The infrastructure is used to create and populate the initial database.
In addition person and organization data is now fetched from the database on the "Contacts" backend server and handed to the "Contacts" frontend server via a page data object.</p>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the result in your browser.
Person and company data is now visible in the user interface as shown in <a href="#img-contacts_tutorial_result_step_3">Figure 31</a>.</p>
</div>
<div id="img-contacts_tutorial_result_step_3" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_3.png" alt="contacts tutorial result step 3">
</div>
<div class="title">Figure 31. The "Contacts" application displaying person data at the end of tutorial step 3.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_forms"><a class="anchor" href="#sec-contacts_forms"></a>Adding a Form to Create/Edit Persons</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this tutorial step we add the Scout forms that are used to create and edit persons and organizations in the user interface.
This tutorial step also provides an introduction into the design and implementation of complex form layouts with the Scout framework.</p>
</div>
<div class="paragraph">
<p>Before we start with the actual implementation of the form <a href="#sec-contacts_form_design">Designing the Person Form</a> provides an introduction to the layouting concepts of the Scout framework.
Based on this information we design a hierarchical form layout for the person form and can then dive into the creation of the person form.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementing the Form (<a href="#sec-contacts_form_implement">Implementing the Form</a>)</p>
</li>
<li>
<p>Adding a Gender Code Type (<a href="#sec-contacts_form_code">Adding a Gender Code Type</a>)</p>
</li>
<li>
<p>Adding Form Fields (<a href="#sec-contacts_form_add_fields">Adding Form Fields</a>)</p>
</li>
<li>
<p>Person Form Handler and Person Service (<a href="#sec-contacts_form_integrate_service">Person Form Handler and Person Service</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The tutorial step concludes with a summary in <a href="#sec-contacts_forms_summary">What have we achieved?</a>.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_design"><a class="anchor" href="#sec-contacts_form_design"></a>Designing the Person Form</h3>
<div class="paragraph">
<p>We start with the sketch of the form layout as shown in <a href="#img-contacts_tutorial_person_form_1">Figure 32</a>.</p>
</div>
<div id="img-contacts_tutorial_person_form_1" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_person_form.png" alt="contacts person form">
</div>
<div class="title">Figure 32. A sketch of the target layout for the person form.</div>
</div>
<div class="paragraph">
<p>The upper half of the form shows a picture of the person and contains some primary attributes such as first name and the gender of the person.</p>
</div>
<div class="paragraph">
<p>The lower half of the form contains tab boxes.
A "Contact Info" tab provides contact details of the person and adding notes for the person in the form of free text is possible in the "Notes" tab.</p>
</div>
<div class="paragraph">
<p><a href="#img-contacts_person_form_grid">Figure 33</a> below shows how the sketched form can fit with the logical grid layout of the Scout framework.
Scout containers have two columns (indicated in red) per default and as many rows (indicated in yellow) as needed.</p>
</div>
<div id="img-contacts_person_form_grid" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_person_form_grid.png" alt="contacts person form grid">
</div>
<div class="title">Figure 33. Logical columns and rows of the Scout form layout. Scout containers have two columns per default.</div>
</div>
<div class="paragraph">
<p>Individual form fields consist of a label part and a field part and occupy a single cell in the logical grid.
Examples for fields using the default configuration are the first name field or the email field.
When needed, fields can be configured to occupy several columns or rows.
An example for this case is the image field that will hold the picture of the person.
This field is configured to occupy 5 logical rows.</p>
</div>
<div class="paragraph">
<p>With Scout&#8217;s container widgets such as group boxes, tab boxes and sequence boxes complex layouts can be achieved.
Containers provide a lot of flexibility as these widgets can be nested hierarchically as shown in <a href="#img-contacts_person_form_groups">Figure 34</a></p>
</div>
<div id="img-contacts_person_form_groups" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_person_form_groups.png" alt="contacts person form groups">
</div>
<div class="title">Figure 34. The hierarchical organization of the form including Scout group boxes, tab boxes and a sequence box.</div>
</div>
<div class="paragraph">
<p>The sketch above details the organization of the container components to match the desired layout for the person form.
The different container widgets can all be used with their default settings except for the address box.</p>
</div>
<div class="paragraph">
<p>For the address box we will have to modify its size and its inner organization.
As group boxes occupy two columns per default we will need to reduce the width of the address box to a single column.
The second change is to the inner layout of the address box.
To force the location box to come below the street field we have to change the inner layout of the group box to a single column as well.
Otherwise, the location box would be shown next to the street field.</p>
</div>
<div class="paragraph">
<p>In the next section we will start to implement the person form with the layout described above.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_implement"><a class="anchor" href="#sec-contacts_form_implement"></a>Implementing the Form</h3>
<div class="paragraph">
<p>In this section we implement the person form with its container widgets as described in the previous section.
To be able to use the form to create and edit persons we will add "New" and "Edit" context menus to the table in the person page.
Finally, we will also add a "Create Person" entry to the "Quick Access" top level menu of the application.</p>
</div>
<div class="paragraph">
<p>Start the form creation with the Scout new form wizard following the steps listed below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand the Maven module <code>contacts.client</code> in the package explorer</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.client.person</code> in folder <code>src/main/java</code></p>
</li>
<li>
<p>For IntelliJ:</p>
<div class="ulist">
<ul>
<li>
<p>Create a new Scout form by right-clicking on the package and selecting <code>New &#8594; Scout Element &#8594; Form</code> as shown in <a href="#img-contacts_create_new_form_Intellij">Figure 35</a></p>
</li>
<li>
<p>Enter "Person" into the <em class="field">Name</em> as shown in <a href="#img-contacts_create_new_person_form_Intellij">Figure 36</a> and then hit <kbd>Enter</kbd></p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>N</kbd></span> and enter "form" into the search field of the wizard selection dialog</p>
</li>
<li>
<p>Select the <em class="element">Scout Form</em> proposal and click the <b class="button">Next</b> button</p>
</li>
<li>
<p>Enter "Person" into the <em class="field">Name</em> and verify that the field contents match <a href="#img-contacts_create_new_person_form">Figure 37</a></p>
</li>
<li>
<p>Click <b class="button">Finish</b> to start the creation of the form and its related components</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="img-contacts_create_new_form_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_create_new_form_Intellij.png" alt="contacts create new form Intellij">
</div>
<div class="title">Figure 35. Create a New Scout Form in IntelliJ.</div>
</div>
<div id="img-contacts_create_new_person_form_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_create_new_person_form_Intellij.png" alt="contacts create new person form Intellij">
</div>
<div class="title">Figure 36. Use the <em class="wizard">New Scout Form</em> to create the person form in IntelliJ.</div>
</div>
<div id="img-contacts_create_new_person_form" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_create_new_person_form.png" alt="contacts create new person form">
</div>
<div class="title">Figure 37. Use the <em class="wizard">New Scout Form</em> to create the person form in Eclipse.</div>
</div>
<div class="paragraph">
<p>Now open the newly created class <code>PersonForm</code> in the Java editor and perform the changes listed below as shown in <a href="#lst-contacts_form_init">Listing 25</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add property <code>personId</code> with the corresponding getter and setter methods</p>
</li>
<li>
<p>Add method <code>computeExclusiveKey</code></p>
</li>
<li>
<p>Add method <code>getConfiguredDisplayHint</code></p>
</li>
<li>
<p>Verify the translated text entry in method <code>getConfiguredTitle</code></p>
</li>
</ul>
</div>
<div id="lst-contacts_form_init" class="listingblock">
<div class="title">Listing 25. Add getConfiguredDisplayHint and the methods related to the person&#8217;s primary key.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("1cde38c1-da32-4fdd-92e7-28d82a5d7bf9")
@FormData(value = PersonFormData.class, sdkCommand = SdkCommand.CREATE) <i class="conum" data-value="1"></i><b>(1)</b>
public class PersonForm extends AbstractForm {

  // represents the person's primary key
  private String personId;

  @FormData <i class="conum" data-value="2"></i><b>(2)</b>
  public String getPersonId() {
    return personId;
  }

  @FormData <i class="conum" data-value="2"></i><b>(2)</b>
  public void setPersonId(String personId) {
    this.personId = personId;
  }

  @Override
  public Object computeExclusiveKey() { <i class="conum" data-value="3"></i><b>(3)</b>
    return getPersonId();
  }

  @Override
  protected int getConfiguredDisplayHint() { <i class="conum" data-value="4"></i><b>(4)</b>
    return IForm.DISPLAY_HINT_VIEW;
  }

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("Person");
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Links the form with its form data class <code>PersonFormData</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation <code>@FormData</code> on the getter and setter method define the <code>personId</code> as a property that will be included in the form data.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The object returned by this method is used by the framework to verify if a specific entity is already opened in some other form.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Configure this form to be opened in the view mode. Views are opened in the bench area of the user interface.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We are now going to add the layout containers according to <a href="#lst-contacts_form_layout">Listing 26</a>.
First add class <code>GeneralBox</code> using the Scout content assist selecting the <em class="element">Group Box</em> proposal.
Delete method <code>getConfiguredLabel</code>, as we are only using this group box to organize fields.</p>
</div>
<div class="paragraph">
<p>After the general box add a tab box container class  by choosing the <em class="element">Tab Box</em> proposal in the Scout content assist.
Inside of class <code>DetailsBox</code> create the individual tab containers "Contact Info", "Work" and "Notes" as inner classes of the details box according to <a href="#lst-contacts_form_layout">Listing 26</a>.</p>
</div>
<div id="lst-contacts_form_layout" class="listingblock">
<div class="title">Listing 26. The layouting structure of the person form using Scout container widgets.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonForm extends AbstractForm {

  @Order(10)
  @ClassId("27a040ac-eac5-47c6-a826-572633b9d4ef")
  public class MainBox extends AbstractGroupBox { <i class="conum" data-value="1"></i><b>(1)</b>

    @Order(10)
    @ClassId("08832a97-8845-4ff4-8dfd-c29366c22742")
    public class GeneralBox extends AbstractGroupBox { <i class="conum" data-value="2"></i><b>(2)</b>
    }

    @Order(20)
    @ClassId("3469046e-ee95-4e86-b0c9-a8ed01fbf664")
    public class DetailsBox extends AbstractTabBox { <i class="conum" data-value="3"></i><b>(3)</b>

      @Order(10)
      @ClassId("2081b483-3d6e-4239-b7da-b6e2d2aa3b7a")
      public class ContactInfoBox extends AbstractGroupBox { <i class="conum" data-value="4"></i><b>(4)</b>

        @Order(10)
        @ClassId("736450dd-ba89-43cd-ba52-bcd31196b462")
        public class AddressBox extends AbstractGroupBox {
        }
      }

      @Order(20)
      @ClassId("8e18a673-aca5-44a2-898f-60a744e4467a")
      public class WorkBox extends AbstractGroupBox {
      }

      @Order(30)
      @ClassId("fcb5b155-2c89-4ef8-9a96-ac41e9032107")
      public class NotesBox extends AbstractGroupBox {
      }
    }

    @Order(30)
    @ClassId("e54548b8-601e-41a4-842c-db25b5f1cad1")
    public class OkButton extends AbstractOkButton {
    }

    @Order(40)
    @ClassId("26612eb9-1832-4284-ac5a-9f450dc7ff9b")
    public class CancelButton extends AbstractCancelButton {
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Every Scout form has a class <code>MainBox</code>. It contains all visible UI components.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>GeneralBox</code> will hold the picture field, first name and last names, the date of birth and the gender.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>DetailsBox</code> tab box will contain the various tabs implemented in inner group boxes.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The containers <code>ContactInfoBox</code>, <code>WorkBox</code> and <code>Notes</code> represent the three tabs of the tab box.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To actually open the person form the form needs to be integrated in the user interface.
In Scout application forms are typically opened by first selecting a specific row in a page and then using a context menu.
For the "Contacts" application we will follow this pattern too.</p>
</div>
<div class="paragraph">
<p>Open class <code>PersonTablePage</code> in the Java editor and create the context menus "New" and "Edit" in the inner class <code>Table</code> according to <a href="#lst-contacts_form_context_menu">Listing 27</a>.</p>
</div>
<div id="lst-contacts_form_context_menu" class="listingblock">
<div class="title">Listing 27. The page context menus to open the person form.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PageData(PersonTablePageData.class)
@ClassId("23c10251-66b1-4bd6-a9d7-93c7d1aedede")
public class PersonTablePage extends AbstractPageWithTable&lt;Table&gt; {

  @ClassId("3fa1374b-9635-441b-b2f8-feb24b50740a")
  public class Table extends AbstractTable {

    @Override
    protected Class&lt;? extends IMenu&gt; getConfiguredDefaultMenu() { <i class="conum" data-value="1"></i><b>(1)</b>
      return EditMenu.class;
    }

    @Order(10)
    @ClassId("4a8f5e0e-6eb8-4296-8ad7-012151f572f2")
    public class EditMenu extends AbstractMenu {
      @Override
      protected String getConfiguredText() {
        return TEXTS.get("Edit");
      }

      @Override
      protected void execAction() {
        PersonForm form = new PersonForm();
        form.setPersonId(getPersonIdColumn().getSelectedValue()); <i class="conum" data-value="2"></i><b>(2)</b>
        form.addFormListener(new PersonFormListener());
        // start the form using its modify handler
        form.startModify();
      }
    }

    @Order(20)
    @ClassId("8ac358f2-de17-4b2b-93f3-73e21a7415d8")
    public class NewMenu extends AbstractMenu {

      @Override
      protected String getConfiguredText() {
        return TEXTS.get("New");
      }

      @Override
      protected Set&lt;? extends IMenuType&gt; getConfiguredMenuTypes() { <i class="conum" data-value="3"></i><b>(3)</b>
        return CollectionUtility.&lt;IMenuType&gt; hashSet(
            TableMenuType.EmptySpace, TableMenuType.SingleSelection);
      }

      @Override
      protected void execAction() {
        PersonForm form = new PersonForm();
        form.addFormListener(new PersonFormListener());
        // start the form using its new handler
        form.startNew();
      }
    }

    private class PersonFormListener implements FormListener {

      @Override
      public void formChanged(FormEvent e) {
        // reload page to reflect new/changed data after saving any changes
        if (FormEvent.TYPE_CLOSED == e.getType() &amp;&amp; e.getForm().isFormStored()) {
          reloadPage();
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This action gets executed when the user presses <kbd>Enter</kbd> on a table row or double clicks on a table row.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Transfer the primary key of the selected person row to the person form.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Including <code>TableMenuType.EmptySpace</code> in the return value activates the "New" menu even when no row is selected.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition to the context menus defined for the person page we also add a "Create new person" menu on the desktop under the "Quick Access" top level menu.
To do this open class <code>Desktop</code> in the Java editor and navigate to the inner class <code>QuickAccessMenu</code>.
We can then add a <code>NewPersonMenu</code> using the Scout content assist and selecting the <em class="element">Menu</em> proposal entry.
The final implementation for the "Create new person" menu is provided in <a href="#lst-contacts_form_quick_menu">Listing 28</a>.</p>
</div>
<div id="lst-contacts_form_quick_menu" class="listingblock">
<div class="title">Listing 28. The "Create new person" menu on the desktop.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("70eda4c8-5aed-4e61-85b4-6098edad8416")
public class Desktop extends AbstractDesktop {

  @Order(10)
  @ClassId("50df7a9d-dd3c-40a3-abc4-4619eff8d841")
  public class QuickAccessMenu extends AbstractMenu {

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("QuickAccess");
    }

    @Order(10)
    @ClassId("effb3b69-f488-4aed-8923-d430a5f1fd97")
    public class NewPersonMenu extends AbstractMenu {

      @Override
      protected String getConfiguredText() {
        return TEXTS.get("NewPersonMenu");
      }

      @Override
      protected void execAction() {
        new PersonForm().startNew();
      }
    }

  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have now created the initial implementation of the person form including context menus to open the form from the person page and the "Quick Access" top level menu of the "Contacts" application.
At this point it is already possible to verify that the person form can be opened on the user interface via the context menus.</p>
</div>
<div class="paragraph">
<p>A screenshot of the current state is shown in <a href="#img-contacts_tutorial_result_step_4_intermediate">Figure 38</a>.</p>
</div>
<div id="img-contacts_tutorial_result_step_4_intermediate" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_4_intermediate.png" alt="contacts tutorial result step 4 intermediate">
</div>
<div class="title">Figure 38. The initial person form and the top level menu "Create new person".</div>
</div>
<div class="paragraph">
<p>This initial implementation of the person form is also ready to add the individual form fields into the container boxes.
For the fields of the person form we can directly extend the abstract form field classes offered by the Scout framework.
Only for the implementation of the gender field we need a Scout code type that represents the possible values for the radio buttons.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_code"><a class="anchor" href="#sec-contacts_form_code"></a>Adding a Gender Code Type</h3>
<div class="paragraph">
<p>In this section we will add a gender code type for the "Contacts" application.
As code types can be used for the specification of the options of a radio button group, we will be able to implement the gender field by providing a reference to the code type.
To keep things simple, the gender code type will contain a "Male" code and a "Female" code.</p>
</div>
<div class="paragraph">
<p>Code types are frequently used in both the frontend and the backend of an application.
This implies that code type classes need to be implemented in the application&#8217;s shared module.
As the gender code type is related to persons we will implement this class in the person package.</p>
</div>
<div class="paragraph">
<p>Follow the steps described below to create the gender code type.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand the Maven module <code>contacts.shared</code> in the package explorer</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.shared.person</code> in folder <code>src/main/java</code></p>
</li>
<li>
<p>For IntelliJ:</p>
<div class="ulist">
<ul>
<li>
<p>Create a new Scout code type by right-clicking on the package and selecting <code>New &#8594; Scout Element &#8594; Code Type</code> as shown in <a href="#img-contacts_tutorial_create_new_gender_codetype_Intellij">Figure 39</a></p>
</li>
<li>
<p>Enter "Gender" into the <em class="field">Name</em> as shown in <a href="#img-contacts_tutorial_new_gender_codetype_Intellij">Figure 40</a> and then hit <kbd>Enter</kbd></p>
</li>
<li>
<p>In the generated code type, change the generics from <code>&lt;Long, Long&gt;</code> to <code>&lt;String, String&gt;</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>N</kbd></span> and enter "code" into the search field of the wizard selection dialog</p>
</li>
<li>
<p>Select the <em class="element">Scout CodeType</em> proposal and click the <b class="button">Next</b> button</p>
</li>
<li>
<p>Enter "Gender" into the <em class="field">Name</em> field and use the type <code>String</code> for the first and second type argument according to <a href="#img-contacts_tutorial_new_gender_codetype">Figure 41</a></p>
</li>
<li>
<p>Click <b class="button">Finish</b>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="img-contacts_tutorial_create_new_gender_codetype_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_create_new_gender_codetype_Intellij.png" alt="contacts tutorial create new gender codetype Intellij">
</div>
<div class="title">Figure 39. Create the gender code in IntelliJ.</div>
</div>
<div id="img-contacts_tutorial_new_gender_codetype_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_new_gender_codetype_Intellij.png" alt="contacts tutorial new gender codetype Intellij">
</div>
<div class="title">Figure 40. Create the gender code using the Scout new code wizard in IntelliJ.</div>
</div>
<div id="img-contacts_tutorial_new_gender_codetype" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_new_gender_codetype.png" alt="contacts tutorial new gender codetype">
</div>
<div class="title">Figure 41. Create the gender code using the Scout new code wizard in Eclipse.</div>
</div>
<div class="paragraph">
<p>Then, open the newly created class <code>GenderCodeType</code> in the Java editor and set the <code>ID</code> constant to "Gender".
The created class will then look like <a href="#lst-contacts_gender_code">Listing 29</a> except for the missing inner code classes.
We will add these inner codes as the next step.</p>
</div>
<div id="lst-contacts_gender_code" class="listingblock">
<div class="title">Listing 29. The Scout code type to represent the gender of a person. This code type will be used for the gender field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("bbe8fae2-4923-42bc-9745-3bb3ef592b12")
public class GenderCodeType extends AbstractCodeType&lt;String, String&gt; {

  private static final long serialVersionUID = 1L;
  public static final String ID = "Gender";

  @Override
  public String getId() {
    return ID;
  }

  @Order(1000)
  @ClassId("8893e1e4-7b6c-46c2-8c84-42c914ec29d5")
  public static class MaleCode extends AbstractCode&lt;String&gt; {

    private static final long serialVersionUID = 1L;
    public static final String ID = "M";

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("Male");
    }

    @Override
    public String getId() {
      return ID;
    }
  }

  @Order(2000)
  @ClassId("23e1540e-2914-401f-9f42-e409ac2fb605")
  public static class FemaleCode extends AbstractCode&lt;String&gt; {

    private static final long serialVersionUID = 1L;
    public static final String ID = "F";

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("Female");
    }

    @Override
    public String getId() {
      return ID;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add an inner class <code>MaleCode</code> code to the gender code type perform the steps below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> and select the <em class="element">Code</em> proposal with a double click</p>
</li>
<li>
<p>Enter "Male" into the first box to be used in the <code>MaleCode</code> class name</p>
</li>
<li>
<p>Tab to the value for the <code>ID</code> constant and set it to "M"</p>
</li>
<li>
<p>Tab to the value in <code>TEXTS.get</code> and add "Male" and its translated text</p>
</li>
<li>
<p>Hit <kbd>Enter</kbd> to finish</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then repeat the steps above for the female code.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_add_fields"><a class="anchor" href="#sec-contacts_form_add_fields"></a>Adding Form Fields</h3>
<div class="paragraph">
<p>In this section we will add the form fields to the layout containers of the person form.
We will start with filling the general box with the picture field, followed by the other fields in the upper part of the person form.
Finally, we fill the individual tab boxes into the details box in the lower part of the person form.</p>
</div>
<div class="paragraph">
<p>As the first field we add the field that will show the picture of the person to the <code>GeneralBox</code> container.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open class <code>PersonForm</code> in the Java editor</p>
</li>
<li>
<p>Place the cursor in the body of the inner class <code>GeneralBox</code>.</p>
</li>
<li>
<p>Copy the code provided in <a href="#lst-contacts_picture_field">Listing 30</a> into the general box.</p>
</li>
<li>
<p>Add for each field a getter method above the MainBox (where all other getters are). Alternatively you could use the SDK to create both fields (including getters) and add the code from <a href="#lst-contacts_picture_field">Listing 30</a>.</p>
</li>
</ol>
</div>
<div id="lst-contacts_picture_field" class="listingblock">
<div class="title">Listing 30. The picture field for the person form.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">      @Order(10)
      @ClassId("617ffd40-0d69-4d02-b4f8-90c28c68c6ce")
      public class PictureUrlField extends AbstractStringField {

        @Override <i class="conum" data-value="1"></i><b>(1)</b>
        protected boolean getConfiguredVisible() {
          return false;
        }
      }

      @Order(20)
      @ClassId("6366a23e-f8ba-4b50-b814-202e63daffc8")
      public class PictureField extends AbstractImageField {

        @Override <i class="conum" data-value="2"></i><b>(2)</b>
        protected Class&lt;PictureUrlField&gt; getConfiguredMasterField() {
          return PictureUrlField.class;
        }

        @Override <i class="conum" data-value="3"></i><b>(3)</b>
        protected void execChangedMasterValue(Object newMasterValue) {
          updateImage((String) newMasterValue);
        }

        @Override
        protected boolean getConfiguredLabelVisible() {
          return false;
        }

        @Override
        protected int getConfiguredGridH() {
          return 5;
        }

        @Override
        protected boolean getConfiguredAutoFit() {
          return true;
        }

        @Override
        protected String getConfiguredImageId() {
          return Icons.User;
        }

        protected void updateImage(String url) {
          setImageUrl(url);
        }
      }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sets the field invisible. An invisible field does not occupy space in the user interface.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Declares <code>PictureUrlField</code> as the master field of the picture field.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>This method will be called when the value of the master field has changed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the combination of the <code>PictureField</code> and <code>PictureUrlField</code> as its master field has two benefits.
First, having a field that contains the the URL makes sure that this information is also stored in the form data and second, the method <code>execChangedMasterValue</code> can then be used to trigger the refresh of the actual picture when the picture URL is changed.</p>
</div>
<div class="paragraph">
<p>For security reasons, the browser is not allowed to load content from other servers by default. For our demo images, we add a well-considered exception. Open the <em>config.properties</em> file of your UI server project and make sure it contains the following line:</p>
</div>
<div class="listingblock">
<div class="title">Listing 31. Content Security Policy Configuration (<em>config.properties</em>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">scout.cspDirective[img-src]='self' www.gravatar.com wiki.eclipse.org upload.wikimedia.org</code></pre>
</div>
</div>
<div class="paragraph">
<p>The remaining fields for the general box can then be added using the Scout content assist or by copying <a href="#lst-contacts_general_fields">Listing 32</a> into the code below the picture field, again not forgetting the getters above the MainBox.</p>
</div>
<div id="lst-contacts_general_fields" class="listingblock">
<div class="title">Listing 32. The other fields in the general box.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">      @Order(30)
      @ClassId("359be835-439f-456e-9b0d-c832b034a298")
      public class FirstNameField extends AbstractStringField {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("FirstName");
        }
      }

      @Order(40)
      @ClassId("8679ade5-21fb-470e-8f00-13bd15199101")
      public class LastNameField extends AbstractStringField {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("LastName");
        }
      }

      @Order(50)
      @ClassId("7c602360-9daa-44b8-abb6-94ccf9b9db59")
      public class DateOfBirthField extends AbstractDateField {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("DateOfBirth");
        }
      }

      @Order(60)
      @ClassId("b9d0593e-3938-4f97-bdca-fdb6a1ce1d77")
      public class GenderGroup extends AbstractRadioButtonGroup&lt;String&gt; {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("Gender");
        }

        @Override <i class="conum" data-value="1"></i><b>(1)</b>
        protected Class&lt;? extends ICodeType&lt;?, String&gt;&gt; getConfiguredCodeType() {
          return GenderCodeType.class;
        }
      }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The codes defined in <code>GenderCodeType</code> will be used to determine the actual radio buttons to add to the gender field.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Whenever we add several fields to a Scout container field the individual fields will be displayed according to their order specified by the <code>@Order</code> annotation in the source code.
Using the default two column layout, the Scout layouting engine uses the first fields to fill up the first column before the remaining fields are assigned to the second column.
In general the Scout layouting engine tries to balance the number of fields over all available columns.
For the general box this rule has the effect that the picture field (this is the first field according to its order value) is assigned to the left column and all other fields are assigned to the right column.</p>
</div>
<div class="paragraph">
<p>After having added all the fields to the general box of the person form we can now fill the individual tabs of the <code>DetailsBox</code> container.
We start with adding the content to the tabs "Work" and "Notes" as described below.</p>
</div>
<div class="paragraph">
<p>Now add the string fields listed below to the "Work" tab as inner classes of the container field <code>WorkBox</code>.
Use the Scout content assist to add the fields and select <em class="element">String Field</em> as the type of each field.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <code>PositionField</code>, using label "Position"</p>
</li>
<li>
<p>Class <code>OrganizationField</code>, using label "Organization"</p>
</li>
<li>
<p>Class <code>PhoneWorkField</code>, using label "Phone"</p>
</li>
<li>
<p>Class <code>EmailWorkField</code>, using label "E-Mail"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The "Notes" tab represented by the container field <code>NotesBox</code> only contains a single string field.
This field will not need a label, span 4 rows of the logical grid and hold a multi line text according to <a href="#lst-contacts_notes_box">Listing 33</a>.</p>
</div>
<div id="lst-contacts_notes_box" class="listingblock">
<div class="title">Listing 33. The notes tab box with its multi line text field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">      @Order(30)
      @ClassId("fcb5b155-2c89-4ef8-9a96-ac41e9032107")
      public class NotesBox extends AbstractGroupBox {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("Notes");
        }

        @Order(10)
        @ClassId("ce791f14-fca6-4f11-8476-89cbf905eb2e")
        public class NotesField extends AbstractStringField {

          @Override
          protected int getConfiguredGridH() {
            return 4;
          }

          @Override
          protected boolean getConfiguredLabelVisible() {
            return false;
          }

          @Override
          protected boolean getConfiguredMultilineText() {
            return true;
          }
        }
      }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next is the implementation of the address box in the "Contact Info" tab.
The address box is realized as a single column group box that holds a street field, a city field and a country field.
According to the form layout defined in <a href="#sec-contacts_form_design">Designing the Person Form</a> the city field and the country field will be located on the same logical row and in the same cell of the logical grid.</p>
</div>
<div class="paragraph">
<p>In the Scout default layout each form field uses up a single cell of the logical grid.
Whenever we like to be more economical with the space occupied by several fields, we can work with a Scout sequence box.
Inner fields of a sequence box will be arranged on a single row from left to right and the spacing between the inner fields will be minimal.</p>
</div>
<div class="paragraph">
<p>Taking advantage of these properties we implement the location box as a sequence field according to <a href="#lst-contacts_address_box">Listing 34</a>.
To further optimize screen real estate we also switch to on-field labels for the city field and the country field.</p>
</div>
<div id="lst-contacts_address_box" class="listingblock">
<div class="title">Listing 34. The content of the address box.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        @Order(10)
        @ClassId("736450dd-ba89-43cd-ba52-bcd31196b462")
        public class AddressBox extends AbstractGroupBox {

          @Override
          protected boolean getConfiguredBorderVisible() {
            return false;
          }

          @Override
          protected int getConfiguredGridH() { <i class="conum" data-value="1"></i><b>(1)</b>
            return 3;
          }

          @Override
          protected int getConfiguredGridW() { <i class="conum" data-value="1"></i><b>(1)</b>
            return 1;
          }

          @Override
          protected int getConfiguredGridColumnCount() { <i class="conum" data-value="2"></i><b>(2)</b>
            return 1;
          }
          @Order(10)
          @ClassId("a9137ad1-af9d-4fef-a69d-3e3d9ce48f21")
          public class StreetField extends AbstractStringField {

            @Override
            protected String getConfiguredLabel() {
              return TEXTS.get("Street");
            }
          }

          // use a sequence box for horizontal layout <i class="conum" data-value="3"></i><b>(3)</b>
          @Order(20)
          @ClassId("a278333c-057e-4c1d-a442-0c1dd62fdca7")
          public class LocationBox extends AbstractSequenceBox {

            @Override
            protected String getConfiguredLabel() {
              return TEXTS.get("Location");
            }

            @Override
            protected boolean getConfiguredAutoCheckFromTo() { <i class="conum" data-value="4"></i><b>(4)</b>
              return false;
            }

            @Order(10)
            @ClassId("3ea6ac2a-976e-4c7f-b04b-ec0d7d1ae5ec")
            public class CityField extends AbstractStringField {

              @Override
              protected String getConfiguredLabel() {
                return TEXTS.get("City");
              }

              @Override
              protected byte getConfiguredLabelPosition() {
                return LABEL_POSITION_ON_FIELD; <i class="conum" data-value="5"></i><b>(5)</b>
              }
            }

            @Order(20)
            @ClassId("d4dfce4f-019b-4a61-ba78-347ef67cf80f")
            public class CountryField extends AbstractSmartField&lt;String&gt; {

              @Override
              protected String getConfiguredLabel() {
                return TEXTS.get("Country");
              }

              @Override
              protected byte getConfiguredLabelPosition() {
                return LABEL_POSITION_ON_FIELD;
              }

              @Override
              protected Class&lt;? extends ILookupCall&lt;String&gt;&gt; getConfiguredLookupCall() {
                return CountryLookupCall.class;
              }
            }
          }
        }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Makes the address box to occupy 1 column and 3 rows.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The content in the address box will use a single column layout.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Extending a Scout sequence box will place the inner fields of the <code>LocationBox</code> on a single row.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Disables the default check if the value of the first field in the sequence box is less than the value in the second field.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>On field labels do not take any additional space and are shown in the field itself.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While string fields are used for the street field and the city field, the country field is implemented as a smart field.
Scout smart fields can be viewed as a powerful drop down lists with search-as-you-type support.
In the case of the country field the smart field is backed by the lookup class <code>CountryLookupCall</code> that we already used for the country smart column in the person page.</p>
</div>
<div class="paragraph">
<p>After the address box the "Contact Info" box contains the three fields mentioned below.
Use the Scout content assist to add the fields and select <em class="element">String Field</em> as the type of each field.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Class <code>PhoneField</code>, using label "Phone"</p>
</li>
<li>
<p>Class <code>MobileField</code>, using label "Mobile"</p>
</li>
<li>
<p>Class <code>EmailField</code>, using label "E-Mail"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We have now completed the implementation of the form layout and added all form fields of the person form.</p>
</div>
<div class="paragraph">
<p>You might not have enough permissions yet to access the person form. For simplicity we will give all permissions to anyone. Follow the steps described below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand the Maven module <code>contacts.server</code> in the Eclipse package explorer</p>
</li>
<li>
<p>Navigate to the package <code>org.eclipse.scout.contacts.server.security</code> in folder <code>src/main/java</code></p>
</li>
<li>
<p>Adjust the file <code>ServerAccessControlService.java</code> according to <a href="#lst-contacts_access_control">Listing 35</a>.</p>
</li>
</ol>
</div>
<div id="lst-contacts_access_control" class="listingblock">
<div class="title">Listing 35. The content of the class <code>ServiceAccessControlService</code>.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Replace
public class ServerAccessControlService extends AccessControlService {

  @Override
  protected IPermissionCollection execLoadPermissions(String userId) {
    return BEANS.get(AllPermissionCollection.class);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The application is now in a state where we can verify the layout of the person form and check the handling of the different input fields.
(Re)start the application and enter some values into the various fields of the person form.</p>
</div>
<div class="paragraph">
<p>To view and enter person data with the form we have yet to add the interaction with the database in the backend of the "Contacts" application.
This is the topic of the next section.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_integrate_service"><a class="anchor" href="#sec-contacts_form_integrate_service"></a>Person Form Handler and Person Service</h3>
<div class="paragraph">
<p>This section shows how we can integrate the person form created in the previous sections with the "Contacts" backend application to load and store person data with the database.</p>
</div>
<div class="paragraph">
<p>Most of the necessary infrastructure such as the transfer objects between the frontend and the backend application has already been created by the Scout form wizard.
In the text below we will first discuss the setup created by the new form wizard and then add the missing code snippets to interact with the database.</p>
</div>
<div class="paragraph">
<p>On the frontend side, the Scout new form wizard has also created the two form handler classes <code>ModifyHandler</code> and <code>NewHandler</code>.
By convention a <code>ModifyHandler</code> is used to change existing data and a <code>NewHandler</code> implements the creation of new data.</p>
</div>
<div class="paragraph">
<p>Form handler classes provide a number of callback methods that are invoked at various stages during the life cycle of the form.
The implementation created by the Scout wizard includes the methods <code>execLoad</code> and <code>execStore</code> for each form handler.
In these methods the form fetches data from the Scout backend application and/or sends new data to the backend server.</p>
</div>
<div class="paragraph">
<p>Adapt the default implementation of the form handlers according to <a href="#lst-contacts_form_handler">Listing 36</a>.</p>
</div>
<div id="lst-contacts_form_handler" class="listingblock">
<div class="title">Listing 36. The new handler and modify handler for the person form.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonForm extends AbstractForm {

  public class ModifyHandler extends AbstractFormHandler {

    @Override
    protected void execLoad() {
      IPersonService service = BEANS.get(IPersonService.class); <i class="conum" data-value="1"></i><b>(1)</b>
      PersonFormData formData = new PersonFormData();
      exportFormData(formData); <i class="conum" data-value="2"></i><b>(2)</b>
      formData = service.load(formData); <i class="conum" data-value="3"></i><b>(3)</b>
      importFormData(formData); <i class="conum" data-value="4"></i><b>(4)</b>

      getForm().setSubTitle(calculateSubTitle()); <i class="conum" data-value="5"></i><b>(5)</b>
    }

    @Override
    protected void execStore() {
      IPersonService service = BEANS.get(IPersonService.class);
      PersonFormData formData = new PersonFormData();
      exportFormData(formData);
      service.store(formData); <i class="conum" data-value="6"></i><b>(6)</b>
    }
  }

  public class NewHandler extends AbstractFormHandler {

    @Override
    protected void execStore() {
      IPersonService service = BEANS.get(IPersonService.class);
      PersonFormData formData = new PersonFormData();
      exportFormData(formData);
      formData = service.create(formData); <i class="conum" data-value="7"></i><b>(7)</b>
      importFormData(formData);
    }
  }

  protected String calculateSubTitle() {
    return StringUtility.join(" ",
        getFirstNameField().getValue(),
        getLastNameField().getValue());
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Obtains a reference to the person service located on the Scout backend application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>All form field values are transferred to the form data. In this case the person primary key property will be transferred to the form data. Remember that we have set this key in the "Edit" context menu.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The form data (including the person primary key) is sent to the <code>load</code> method. The load method returns the person data from the backend.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The field values in the form data are loaded into the form fields of the person form.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The sub title on the view tab of the form is updated to reflect the name of the person.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Calls the <code>store</code> method of the person service providing the updated person data.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Calls the <code>create</code> method of the person service providing the new person data.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With the implementation provided in <a href="#lst-contacts_form_handler">Listing 36</a> the classes <code>ModifyHandler</code> and <code>NewHandler</code> orchestrate the complete roundtrip between the frontend and the backend of the "Contacts" application.</p>
</div>
<div class="paragraph">
<p>The only part that is now missing is the implementation of the form service methods <code>create</code>, <code>load</code> and <code>store</code> on the backend of the "Contacts" application.
For these methods we can again rely on the default implementations created by the Scout new form wizard.</p>
</div>
<div class="paragraph">
<p>Modify the person service methods according to <a href="#lst-contacts_form_service">Listing 37</a>.</p>
</div>
<div id="lst-contacts_form_service" class="listingblock">
<div class="title">Listing 37. The PersonService methods to load, create and update person data.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonService implements IPersonService {

  @Override
  public PersonFormData create(PersonFormData formData) {
    if (!ACCESS.check(new CreatePersonPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    // add a unique person id if necessary
    if (StringUtility.isNullOrEmpty(formData.getPersonId())) {
      formData.setPersonId(UUID.randomUUID().toString());
    }

    SQL.insert(SQLs.PERSON_INSERT, formData); <i class="conum" data-value="1"></i><b>(1)</b>

    return store(formData); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  @Override
  public PersonFormData load(PersonFormData formData) {
    if (!ACCESS.check(new ReadPersonPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    SQL.selectInto(SQLs.PERSON_SELECT, formData); <i class="conum" data-value="3"></i><b>(3)</b>

    return formData;
  }

  @Override
  public PersonFormData store(PersonFormData formData) {
    if (!ACCESS.check(new UpdatePersonPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    SQL.update(SQLs.PERSON_UPDATE, formData); <i class="conum" data-value="4"></i><b>(4)</b>

    return formData;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The SQL insert statement adds a new person entry in the database. Only the primary key is used to create this entry.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>To save all other person attributes provided in the form data, the <code>store</code> method is reused.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The SQL select into transfers the person data from the database into the form data.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The SQL update statement transfers all person attributes provided in the form data to the person table.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_forms_summary"><a class="anchor" href="#sec-contacts_forms_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the fourth step of the "Contacts" tutorial we have added the person form to add, view and change persons.
Using the person form as an example we have learned how to implement complex form layouts using the Scout layouting mechanism, Scout container fields and individual form field properties.</p>
</div>
<div class="paragraph">
<p>We have also seen how we can use context menus to integrate the forms in the user interface of the application and have implemented the interaction of the frontend with the backend application including the persistance of person data in the database.</p>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the result in your browser.
We can now verify the creation of new person entries and the modification of existing person data in the current state of the "Contacts" application.
The created person form is shown in <a href="#img-contacts_tutorial_result_step_4">Figure 42</a>.
In case you copied some code snippets from the tutorial, you may see the text "undefined text {&#8230;&#8203;}" in some labels in the person field.
You may want to define these texts using the Scout content assist for defining new texts as was already presented earlier in this tutorial.</p>
</div>
<div id="img-contacts_tutorial_result_step_4" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_4.png" alt="contacts tutorial result step 4">
</div>
<div class="title">Figure 42. The "Contacts" application with the person form at the end of tutorial step 4.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_fields"><a class="anchor" href="#sec-contacts_fields"></a>Form Field Validation and Template Fields</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial step introduces two additional concepts that are used in most Scout applications.
Form field validation and template fields.
Form field validation helps to keep data quality high and template fields are used to increase the code quality of a Scout application.</p>
</div>
<div class="paragraph">
<p>In addition to just retrieving and storing new data, a business application should also help the user to maintain the quality of the entered data.
To validate user input, the Scout framework offers form field validation.
Simple input validation is possible on the level of individual fields as shown in <a href="#sec-contacts_field_validation">Simple Form Field Validation</a>.
Scout also offers mechanisms to validate field values on the level of container fields or on the level of a form as shown in <a href="#sec-contacts_field_validation_complex">Complex Form Field Validation</a>.
In the text below we add a number of form field validations that implement this approach for the person form.</p>
</div>
<div class="paragraph">
<p>In <a href="#sec-contacts_form_templatefields">Creating Template Fields</a> we refactor the picture field code into a template field that can later be re-used for the organization form.
To edit the image URL we add a simple edit form to the refactored picture field in <a href="#sec-contacts_form_urleditform">Adding a simple URL Input Form to the Picture Field</a>.</p>
</div>
<div class="paragraph">
<p>In <a href="#sec-contacts_form_templatefields_more">More Template Fields</a> we outline the creation of additional template fields and provide a summary of this tutorial step in <a href="#sec-contacts_form_templatefields_summary">What have we achieved?</a>.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_field_validation"><a class="anchor" href="#sec-contacts_field_validation"></a>Simple Form Field Validation</h3>
<div class="paragraph">
<p>This section explains the form field validation on the level of a single field.
As an example we will use the email address field defined in the "Contact Info" tab.
The validation implemented in <a href="#lst-contacts_validate_email">Listing 38</a> checks the length and the format of the entered email address.</p>
</div>
<div id="lst-contacts_validate_email" class="listingblock">
<div class="title">Listing 38. The validation of the email field</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        @Order(40)
        @ClassId("5f9d9363-8e57-4151-b281-7d401e64702c")
        public class EmailField extends AbstractStringField {

          private static final String EMAIL_PATTERN = <i class="conum" data-value="1"></i><b>(1)</b>
              "^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)*@" +
                  "[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$";

          @Override
          protected String getConfiguredLabel() {
            return TEXTS.get("Email");
          }

          @Override <i class="conum" data-value="2"></i><b>(2)</b>
          protected int getConfiguredMaxLength() {
            return 64;
          }

          @Override <i class="conum" data-value="3"></i><b>(3)</b>
          protected String execValidateValue(String rawValue) {
            if (rawValue != null &amp;&amp; !Pattern.matches(EMAIL_PATTERN, rawValue)) {
              throw new VetoException(TEXTS.get("BadEmailAddress")); <i class="conum" data-value="4"></i><b>(4)</b>
            }

            return rawValue; <i class="conum" data-value="5"></i><b>(5)</b>
          }
        }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Email verification is performed against a simple regular expression.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This prevents the field from accepting more than 64 characters. The return value should match the size of the corresponding table column.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Method <code>execValidateValue</code> is called during validation of the new field value.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If the value violates any business rules, a <code>VetoException</code> should be thrown.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>If the new value passes all business rules the method returns the value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the next section we use the address box to demonstrate the joint validation of several fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_field_validation_complex"><a class="anchor" href="#sec-contacts_field_validation_complex"></a>Complex Form Field Validation</h3>
<div class="paragraph">
<p>Often the values of several fields have to be considered jointly to evaluate if the entered data is actually valid.
As an example we will add a more complex form field validation on the level of the <code>AddressBox</code> group box widget that takes into account the data entered into the street, city, and country fields.</p>
</div>
<div class="paragraph">
<p>The implemented validation for the address box example should enforce the following set of business rules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only valid countries should be allowed</p>
</li>
<li>
<p>If a city is provided a country must also be provided</p>
</li>
<li>
<p>If street information is provided, both a city and a country must be provided</p>
</li>
<li>
<p>The address may be empty</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The simplest rule is about entering only valid countries.
This rule is already implemented as the country smart field only allows the user to select a single entry of the list of valid countries.
A possible implementation to enforce the other rules is provided in <a href="#lst-contacts_validate_address">Listing 39</a>.</p>
</div>
<div id="lst-contacts_validate_address" class="listingblock">
<div class="title">Listing 39. The validation of the fields in the address box</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        @Order(10)
        @ClassId("736450dd-ba89-43cd-ba52-bcd31196b462")
        public class AddressBox extends AbstractGroupBox {

          @Order(10)
          @ClassId("a9137ad1-af9d-4fef-a69d-3e3d9ce48f21")
          public class StreetField extends AbstractStringField {

            @Override <i class="conum" data-value="1"></i><b>(1)</b>
            protected void execChangedValue() {
              validateAddressFields(); <i class="conum" data-value="2"></i><b>(2)</b>
            }
          }

          @Order(20)
          @ClassId("a278333c-057e-4c1d-a442-0c1dd62fdca7")
          public class LocationBox extends AbstractSequenceBox {

            @Order(10)
            @ClassId("3ea6ac2a-976e-4c7f-b04b-ec0d7d1ae5ec")
            public class CityField extends AbstractStringField {

              @Override
              protected void execChangedValue() {
                validateAddressFields(); <i class="conum" data-value="2"></i><b>(2)</b>
              }
            }

            @Order(20)
            @ClassId("d4dfce4f-019b-4a61-ba78-347ef67cf80f")
            public class CountryField extends AbstractSmartField&lt;String&gt; {

              @Override
              protected void execChangedValue() {
                validateAddressFields(); <i class="conum" data-value="2"></i><b>(2)</b>
              }
            }
          }

          protected void validateAddressFields() {
            boolean hasStreet = StringUtility.hasText(getStreetField().getValue());
            boolean hasCity = StringUtility.hasText(getCityField().getValue());

            getCityField().setMandatory(hasStreet); <i class="conum" data-value="3"></i><b>(3)</b>
            getCountryField().setMandatory(hasStreet || hasCity);
          }
        }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This method is called after the value of this field has been changed.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>After changing the street, the city or the country recompute which address fields are mandatory.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The city becomes mandatory if the street field is not empty. The country is mandatory if the street or the city is not empty.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Whenever the content of the street field, the city field, or the country field is changed the mechanism implemented above triggers a re-evaluation of the mandatory status of the city field and the country field.
As the Scout default form validation ensures that every mandatory field receives some content the application prevents the user from entering address data that does not satisfy the business rules mentioned above.</p>
</div>
<div class="paragraph">
<p>The verification of user input can also be triggered before the form is closed.
This behavior can be implemented by overriding method <code>execValidate</code> on the form level.
As an example we use this mechanism to make sure that a user can only enter persons that have at least some name information.</p>
</div>
<div class="paragraph">
<p>Now add this validation to the person form using the implementation provided in <a href="#lst-contacts_validate_names">Listing 40</a>.</p>
</div>
<div id="lst-contacts_validate_names" class="listingblock">
<div class="title">Listing 40. The validation of the first and last names on the form level</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonForm extends AbstractForm {

  @Override <i class="conum" data-value="1"></i><b>(1)</b>
  protected boolean execValidate() {
    boolean noFirstName = StringUtility.isNullOrEmpty(getFirstNameField().getValue());
    boolean noLastName = StringUtility.isNullOrEmpty(getLastNameField().getValue());

    if (noFirstName &amp;&amp; noLastName) {
      getFirstNameField().requestFocus(); <i class="conum" data-value="2"></i><b>(2)</b>

      throw new VetoException(TEXTS.get("MissingName")); <i class="conum" data-value="3"></i><b>(3)</b>
    }

    return true; <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This method is called during the form validation and before the form is stored/closed.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Place the focus on the first name field.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>In case both the first name and the last name fields are empty throw a VetoException, this will fail the validation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The return value indicates if the validation has passed successfully or not.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As we have now implemented a number of form field validations we are now ready to test the result in the running application.
Re-start the "Contacts" application and try to trigger the different validation rules.
<a href="#img-contacts_tutorial_result_step_5a">Figure 43</a> shows the response of the user interface when trying to save invalid person data.</p>
</div>
<div id="img-contacts_tutorial_result_step_5a" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_5a.png" alt="contacts tutorial result step 5a">
</div>
<div class="title">Figure 43. The form field validation implemented for the person form.</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_templatefields"><a class="anchor" href="#sec-contacts_form_templatefields"></a>Creating Template Fields</h3>
<div class="paragraph">
<p>In this section we show how to refactor a group of fields into a Scout template field that is ready for reuse.
As an example we refactor the picture field into a template field.
Later in tutorial step <a href="#sec-contacts_form_add_company">Adding the Company Form</a> we can then reuse this field in the company form to show the company&#8217;s logo.</p>
</div>
<div class="paragraph">
<p>The generic approach to refactor a form field into a template field is listed below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an empty field data class in the shared module</p>
</li>
<li>
<p>Create the template field class in the client module</p>
</li>
<li>
<p>Copy the existing field code to the template field</p>
</li>
<li>
<p>Let the original field extend the new template field and fix imports</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For refactoring the picture field we can exactly follow these steps.
To create the empty field data class perform the following steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand the shared module of the "Contacts" application</p>
</li>
<li>
<p>Navigate into folder <code>src/generated/java</code></p>
</li>
<li>
<p>Add a new package <code>org.eclipse.scout.contacts.shared.common</code></p>
</li>
<li>
<p>Create class <code>AbstractUrlImageFieldData</code> in this package as shown in <a href="#lst-contacts_empty_form_data">Listing 41</a></p>
</li>
</ol>
</div>
<div id="lst-contacts_empty_form_data" class="listingblock">
<div class="title">Listing 41. The empty form data class for the picture template field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.eclipse.scout.contacts.shared.common;

public abstract class AbstractUrlImageFieldData {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are now ready to implement the template field class according to the following steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the client module of the "Contacts" application</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.client.common</code> in folder <code>src/main/java</code></p>
</li>
<li>
<p>Create a new Java class called <code>AbstractUrlImageField</code> and update the implementation according to <a href="#lst-contacts_refactor_picture">Listing 42</a></p>
</li>
</ol>
</div>
<div id="lst-contacts_refactor_picture" class="listingblock">
<div class="title">Listing 42. The refactored picture field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("73a4276f-77b2-4ad2-b414-7f806284bdb3")
@FormData(value = AbstractUrlImageFieldData.class, <i class="conum" data-value="1"></i><b>(1)</b>
    sdkCommand = SdkCommand.CREATE,
    defaultSubtypeSdkCommand = DefaultSubtypeSdkCommand.CREATE)
public abstract class AbstractUrlImageField extends AbstractImageField {

  private String url; <i class="conum" data-value="2"></i><b>(2)</b>

  @FormData <i class="conum" data-value="2"></i><b>(2)</b>
  public String getUrl() {
    return url;
  }

  @FormData <i class="conum" data-value="2"></i><b>(2)</b>
  public void setUrl(String url) {
    this.url = url;
    updateImage();
  }

  @Override
  protected boolean getConfiguredLabelVisible() {
    return false;
  }

  @Override
  protected int getConfiguredGridH() {
    return 5;
  }

  @Override
  protected boolean getConfiguredAutoFit() {
    return true;
  }

  @Override
  protected String getConfiguredImageId() {
    return Icons.User;
  }


  protected void updateImage() {
    setImageUrl(this.url);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The link to the corresponding field data class.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Field <code>PictureUrlField</code> is refactored into the property <code>url</code> value. To transfer the content of this property to the field data object we need to add annotation <code>@FormData</code> to its getter and setter methods.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next step is to replace the original code of the picture field with the newly created template field.
Delete the field <code>PictureUrlField</code> and remove all the code from the field <code>PictureField</code> and let <code>PictureField</code> extend the newly created template field as shown in <a href="#lst-contacts_picture_exends_urlimagefield">Listing 43</a>.</p>
</div>
<div id="lst-contacts_picture_exends_urlimagefield" class="listingblock">
<div class="title">Listing 43. The refactored picture field.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Order(10)
  @ClassId("e7efc084-fe7a-462f-ba23-914e58f7b82d")
  public class MainBox extends AbstractGroupBox {
    @Order(10)
    @ClassId("b20aad47-e070-4f3c-bafc-ddbaa3ae2a4c")
    public class GeneralBox extends AbstractGroupBox {

      @Order(10)
      @ClassId("d80625e3-b548-47e4-9cae-42d70aaa568f")
      public class PictureField extends AbstractUrlImageField { <i class="conum" data-value="1"></i><b>(1)</b>
      }

      // additional form field

    }
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The implementation of the picture field is now provided by the template field <code>AbstractUrlImageField</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As the last step we need to slightly modify the SQL statement that loads and stores the picture URL information.
The reason for the change is the replacement of the picture url field by an url property defined as a member of the picture field.
For this change perform the steps listed below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open class <code>SQLs</code> in the Java editor.</p>
</li>
<li>
<p>In string <code>PERSON_SELECT</code> change the token ':pictureUrl' with ':picture.url'</p>
</li>
<li>
<p>In string <code>PERSON_UPDATE</code> change the token ':pictureUrl' with ':picture.url'</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Based on the picture field example we have now walked through the complete process to turn normal fields into template fields.
This process remains the same for refactoring container fields into template fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_urleditform"><a class="anchor" href="#sec-contacts_form_urleditform"></a>Adding a simple URL Input Form to the Picture Field</h3>
<div class="paragraph">
<p>Using the refactored picture template field we want the user to be able to enter and update the URL of the shown picture.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We create a new form called <code>PictureUrl</code> as we&#8217;ve done before as shown in <a href="#img-sdk_new_form_pictureurl_Intellij">Figure 44</a> (IntelliJ) or <a href="#img-sdk_new_form_pictureurl">Figure 45</a> (Eclipse).</p>
</li>
<li>
<p>For Eclipse:</p>
<div class="ulist">
<ul>
<li>
<p>Verify that you use the correct source folder and package name.</p>
</li>
<li>
<p>In the <em class="element">Name</em> field enter "PictureUrl".</p>
</li>
<li>
<p>In section <em class="element">Additional Components</em> deselect all checkboxes.</p>
</li>
<li>
<p>Click <b class="button">Finish</b> to let the wizard implement the form.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="img-sdk_new_form_pictureurl_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_form_pictureurl_Intellij.png" alt="sdk new form pictureurl Intellij">
</div>
<div class="title">Figure 44. Creating the picture URL form with the new form wizard in IntelliJ.</div>
</div>
<div id="img-sdk_new_form_pictureurl" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_form_pictureurl.png" alt="sdk new form pictureurl">
</div>
<div class="title">Figure 45. Creating the picture URL form with the new form wizard in Eclipse.</div>
</div>
<div class="paragraph">
<p>Now adapt the content of the URL form according to <a href="#lst-contacts_form_pictureurl">Listing 44</a>.
As you can see, there is no roundtrip to a backend server and the form only contains a single editable field.</p>
</div>
<div id="lst-contacts_form_pictureurl" class="listingblock">
<div class="title">Listing 44. The form to edit the picture URL</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("3b30ebf1-e8fe-4dd3-8124-5f5038b1d47c")
public class PictureUrlForm extends AbstractForm {

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("PictureURL");
  }

  public void startModify() {
    startInternal(new ModifyHandler());
  }

  public UrlField getUrlField() {
    return getFieldByClass(UrlField.class);
  }

  public InfoField getInfoField() {
    return getFieldByClass(InfoField.class);
  }

  @Order(10)
  @ClassId("6c5e0da2-cf04-402f-9784-43e3a138796b")
  public class MainBox extends AbstractGroupBox {

    @Order(10)
    @ClassId("fdcc7087-a693-45e8-a889-3725b0995558")
    public class UrlBox extends AbstractGroupBox {

      @Order(10)
      @ClassId("32b71aa6-1109-4b39-996f-f35a677faa06")
      public class UrlField extends AbstractStringField {

        @Override
        protected boolean getConfiguredLabelVisible() { <i class="conum" data-value="1"></i><b>(1)</b>
          return false;
        }

        @Override
        protected boolean getConfiguredStatusVisible() {
          return false;
        }

        @Override
        protected int getConfiguredGridW() {
          return 2;
        }
      }

      @Order(20)
      @ClassId("999c32e9-ca87-4b5c-a907-29d7a7400abf")
      public class InfoField extends AbstractHtmlField {

        @Override
        protected boolean getConfiguredLabelVisible() {
          return false;
        }

        @Override
        protected boolean getConfiguredStatusVisible() {
          return false;
        }

        @Override
        protected int getConfiguredGridW() {
          return 2;
        }

        @Override
        protected boolean getConfiguredGridUseUiHeight() {
          return true;
        }

        @Override
        protected void execInitField() {
          setValue(HTML.fragment(HTML.icon(Icons.Info), HTML.bold(" " + TEXTS.get("PleaseNote") + ": "), TEXTS.get("SecurityUrlRestrictedMsg")).toHtml());
        }
      }
    }

    @Order(20)
    @ClassId("4e15ce0e-502c-4290-aeca-e83359f3bc5b")
    public class OkButton extends AbstractOkButton {
    }

    @Order(30)
    @ClassId("f278815a-f4cf-4e86-a057-66cb7ce43fc3")
    public class CancelButton extends AbstractCancelButton {
    }
  }

  public class ModifyHandler extends AbstractFormHandler { <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>No label is needed as the name of the field is already provided by the title of the form.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>As no round trip to the backend is required the modify handler can remain empty.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can now add an "Edit URL" menu to the picture template field.
The implementation of the edit context menu is provided in <a href="#lst-contacts_picture_edit_menu">Listing 45</a>.</p>
</div>
<div id="lst-contacts_picture_edit_menu" class="listingblock">
<div class="title">Listing 45. The "Edit URL" menu for the refactored picture field</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class AbstractUrlImageField extends AbstractImageField {

  @Order(10)
  @ClassId("99c1c12a-84d4-4c1a-a009-dfd2b7b55ded")
  public class EditURLMenu extends AbstractMenu {

    @Override
    protected String getConfiguredText() {
      return TEXTS.get("EditURL");
    }

    @Override
    protected Set&lt;? extends IMenuType&gt; getConfiguredMenuTypes() {
      return CollectionUtility.&lt;IMenuType&gt; hashSet(
          ImageFieldMenuType.ImageUrl,
          ImageFieldMenuType.ImageId,
          ImageFieldMenuType.Null);
    }

    @Override
    protected void execAction() {
      PictureUrlForm form = new PictureUrlForm();
      String oldUrl = getUrl();

      if (StringUtility.hasText(oldUrl)) { <i class="conum" data-value="1"></i><b>(1)</b>
        form.getUrlField().setValue(oldUrl);
      }

      form.startModify();
      form.waitFor(); <i class="conum" data-value="2"></i><b>(2)</b>

      if (form.isFormStored()) { <i class="conum" data-value="3"></i><b>(3)</b>
        setUrl(form.getUrlField().getValue());
        getForm().touch();
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If we already have an URL for the picture prefill the url field in the form with its value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Method <code>waitFor</code> makes the application wait until the user has closed the form.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Only store the new URL if the user has saved a new value. Storing the value will refresh the picture in the user interface.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on the example with the picture field we have now walked through the complete process to turn normal fields into template fields.
This process remains the same for refactoring container fields into template fields.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_templatefields_more"><a class="anchor" href="#sec-contacts_form_templatefields_more"></a>More Template Fields</h3>
<div class="paragraph">
<p>To reduce the amount of copy &amp; paste for the implementation of the company form in the next tutorial step, we recommend that you refactor the following fields into templates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Email field</p>
</li>
<li>
<p>Address group box field</p>
</li>
<li>
<p>Notes group box field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can follow the steps described in the previous section for the picture field.
To be able to copy &amp; paste the code in the following tutorial step you may use the following class names.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AbstractEmailField</code> for the email template field</p>
</li>
<li>
<p><code>AbstractAddressBox</code> for the address group template field</p>
</li>
<li>
<p><code>AbstractNotesBox</code> for the notes tab template field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that both the <code>AbstractAddressBox</code> and the <code>AbstractNotesBox</code> need their own form data object, whereas the <code>AbstractEmailField</code> does not.</p>
</div>
<div class="paragraph">
<p>Replacing the concrete fields with the template fields in the person form will result in a number of compile errors in the field getter methods of the person form.
In the case of the "Contacts" application these getter methods are not needed and can simply be deleted.</p>
</div>
<div class="paragraph">
<p>Moving from concrete fields to template fields also implies some minor changes as we have seen with the picture template field.
Therefore make sure to modify the SQL statements in class <code>SQLs</code> accordingly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace token ':street' by ':addressBox.street'</p>
</li>
<li>
<p>Replace token ':city' by ':addressBox.city'</p>
</li>
<li>
<p>Replace token ':country' by ':addressBox.country'</p>
</li>
<li>
<p>Replace token ':notes' by ':notesBox.notes'</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_templatefields_summary"><a class="anchor" href="#sec-contacts_form_templatefields_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In this step of the "Contacts" tutorial we have covered two important concepts for implementing business applications.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validation of user input on the level of fields, components and the complete form</p>
</li>
<li>
<p>Creation and usage of template fields to minimize copy &amp; paste where possible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the result in your browser.
Using the created picture template field we can now update the image in the picture form as shown in <a href="#img-contacts_tutorial_result_step_5b">Figure 46</a>.</p>
</div>
<div id="img-contacts_tutorial_result_step_5b" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_5b.png" alt="contacts tutorial result step 5b">
</div>
<div class="title">Figure 46. The person form with the refactored picture template field including a menu (red square) and a URL edit form.</div>
</div>
<div class="paragraph">
<p>In the next tutorial step we are going to implement the company form to enter and edit company information.
For the creation of this form we can reuse the template fields that we have created.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_form_add_company"><a class="anchor" href="#sec-contacts_form_add_company"></a>Adding the Company Form</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the implementation of the organization form.
For the implementation of the organization form we can apply many of the concepts we have learned in the previous sections.
As a result, the descriptions of this section can be kept on a much higher level.</p>
</div>
<div id="img-contacts_organization_form" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_organization_form.png" alt="contacts organization form">
</div>
<div class="title">Figure 47. The sketch of the organization form layout.</div>
</div>
<div class="paragraph">
<p>Considering the layout sketch for the organization form shown in <a href="#img-contacts_organization_form">Figure 47</a> we can already see how we can reuse the following fields / templates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The picture field</p>
</li>
<li>
<p>The address box with street, city and country including its validation</p>
</li>
<li>
<p>The email field with its validation</p>
</li>
<li>
<p>The complete "Notes" tab</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the remaining fields "Name", "Homepage" and "Phone" we will use simple string fields with matching label texts.</p>
</div>
<div class="paragraph">
<p>We can now implement the company form according to the following steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand folder <code>src/main/java</code> in the client module in the package explorer</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.client.organization</code> and create a new form called "OrganizationForm" as we&#8217;ve done before</p>
</li>
<li>
<p>Hit <kbd>Enter</kbd> for IntelliJ or click <b class="button">Finish</b> for Eclipse</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After creating the initial form class using Scout&#8217;s new form wizard the form layout can be implemented according to <a href="#lst-contacts_organization">Listing 46</a>.</p>
</div>
<div id="lst-contacts_organization" class="listingblock">
<div class="title">Listing 46. The layout implementation of the organization form</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class OrganizationForm extends AbstractForm {

  private String organizationId;

  @FormData
  public String getOrganizationId() {
    return organizationId;
  }

  @FormData
  public void setOrganizationId(String organizationId) {
    this.organizationId = organizationId;
  }

  @Override
  public Object computeExclusiveKey() {
    return getOrganizationId();
  }

  @Override
  protected String getConfiguredTitle() {
    return TEXTS.get("Organization");
  }

  @Override
  protected int getConfiguredDisplayHint() {
    return IForm.DISPLAY_HINT_VIEW;
  }
  @Order(10)
  @ClassId("e7efc084-fe7a-462f-ba23-914e58f7b82d")
  public class MainBox extends AbstractGroupBox {
    @Order(10)
    @ClassId("b20aad47-e070-4f3c-bafc-ddbaa3ae2a4c")
    public class GeneralBox extends AbstractGroupBox {

      @Order(10)
      @ClassId("d80625e3-b548-47e4-9cae-42d70aaa568f")
      public class PictureField extends AbstractUrlImageField { <i class="conum" data-value="1"></i><b>(1)</b>

        @Override
        protected int getConfiguredGridH() { <i class="conum" data-value="2"></i><b>(2)</b>
          return 4;
        }

        @Override
        protected double getConfiguredGridWeightY() { <i class="conum" data-value="3"></i><b>(3)</b>
          return 0;
        }
      }

      @Order(20)
      @ClassId("4c1a0dea-6c04-4cad-b26b-8d5cc1b786a9")
      public class NameField extends AbstractStringField {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("Name");
        }

        @Override
        protected boolean getConfiguredMandatory() { <i class="conum" data-value="4"></i><b>(4)</b>
          return true;
        }
      }

      @Order(30)
      @ClassId("68008603-257f-45dc-b8ea-d1e066682205")
      public class HomepageField extends AbstractStringField {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("Homepage");
        }
      }
    }

    @Order(20)
    @ClassId("4e48c196-22e4-4e22-965a-5e305af5e6a9")
    public class DetailsBox extends AbstractTabBox {

      @Order(10)
      @ClassId("c6c9e644-2ab3-436e-9d8a-bdcc5482eb5b")
      public class ContactInfoBox extends AbstractGroupBox {

        @Override
        protected String getConfiguredLabel() {
          return TEXTS.get("ContactInfo");
        }

        @Order(10)
        @ClassId("2a10bd00-de56-4a97-a5b2-6a8a0aae925f")
        public class AddressBox extends AbstractAddressBox { <i class="conum" data-value="5"></i><b>(5)</b>
        }

        @Order(20)
        @ClassId("504a4845-d307-4238-a2e9-9e785c1477ac")
        public class PhoneField extends AbstractStringField {

          @Override
          protected String getConfiguredLabel() {
            return TEXTS.get("Phone");
          }
        }

        @Order(30)
        @ClassId("0b4d059d-ec81-4e93-9a99-2512d734ebac")
        public class EmailField extends AbstractEmailField { <i class="conum" data-value="6"></i><b>(6)</b>
        }
      }

      @Order(20)
      @ClassId("85f4dfb0-f375-4e90-be92-b59e9bc2ebcf")
      public class NotesBox extends AbstractNotesBox { <i class="conum" data-value="7"></i><b>(7)</b>
      }
    }

    @Order(30)
    @ClassId("97c3ceed-d005-47da-b44d-def4b07f92ab")
    public class OkButton extends AbstractOkButton {
    }

    @Order(40)
    @ClassId("d63bfcd6-7464-4e4f-a07e-eb1173a77f8c")
    public class CancelButton extends AbstractCancelButton {
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We reuse the picture template field to display the company logo.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We reduce the number of rows for the company logo compared to the person picture.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We do not allow the general box to grow or shrink vertically</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We configure the company name field to be mandatory for an organization.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>As-is reuse of the address template box.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>As-is reuse of the email template field.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>As-is reuse of the notes tab box.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To be able to open the organization form we need to link the form to the user interface.
Following the pattern for the person form we define the context menus "Edit" and "New" for the organization table and a menu "Create new organization" under the "Quick access" top level menu.</p>
</div>
<div class="paragraph">
<p>The implementation of the organization form is completed by providing the logic to interact with the database in the organization service according to <a href="#lst-contacts_form_service_organization">Listing 47</a>.
The technical setup exactly follows the implementation of the person service.</p>
</div>
<div id="lst-contacts_form_service_organization" class="listingblock">
<div class="title">Listing 47. The OrganizationService methods to load, create and update organization data.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class OrganizationService implements IOrganizationService {

  @Override
  public OrganizationFormData create(OrganizationFormData formData) {
    if (!ACCESS.check(new CreateOrganizationPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    if (StringUtility.isNullOrEmpty(formData.getOrganizationId())) {
      formData.setOrganizationId(UUID.randomUUID().toString());
    }

    SQL.insert(SQLs.ORGANIZATION_INSERT, formData);

    return store(formData);
  }

  @Override
  public OrganizationFormData load(OrganizationFormData formData) {
    if (!ACCESS.check(new ReadOrganizationPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    SQL.selectInto(SQLs.ORGANIZATION_SELECT, formData);

    return formData;
  }

  @Override
  public OrganizationFormData store(OrganizationFormData formData) {
    if (!ACCESS.check(new UpdateOrganizationPermission())) {
      throw new VetoException(TEXTS.get("InsufficientPrivileges"));
    }

    SQL.update(SQLs.ORGANIZATION_UPDATE, formData);

    return formData;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Method <code>prepareCreate</code> is not needed for the creation of a new organization and we can remove it from <code>OrganizationService</code> and <code>IOrganizationService</code>.
Therefore, the implementation of the method <code>execLoad</code> in the new handler of the organization form can also be removed.</p>
</div>
<div class="paragraph">
<p>With these implementations of the organization form and organization service the "Contacts" application can now also be used to maintain a list of organizations.</p>
</div>
<div class="sect2">
<h3 id="sec-contacts_form_rest_summary"><a class="anchor" href="#sec-contacts_form_rest_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the sixth step of the "Contacts" tutorial we have added the Scout form to edit and create organizations.
The focus of this part of the tutorial was on re-using previous work and applying the concepts that have been introduced in previous tutorial steps.</p>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the result in your browser.
As shown in <a href="#img-contacts_tutorial_result_step_6">Figure 48</a> company data can now be viewed and entered in the user interface.</p>
</div>
<div id="img-contacts_tutorial_result_step_6" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_6.png" alt="contacts tutorial result step 6">
</div>
<div class="title">Figure 48. The "Contacts" application with the newly created organization form.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-contacts_link_organization_person"><a class="anchor" href="#sec-contacts_link_organization_person"></a>Linking Organizations and Persons</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this step we modify the user interface to represent the 1:n relationship between organizations and persons.
For the implementation of this 1:n relation we follow the Scout standard pattern.</p>
</div>
<div class="paragraph">
<p>In the "Contacts" application any person can be assigned to a single organization.
This fact is represented in the database schema created using the statement <code>SQLs.PERSON_CREATE_TABLE</code>.</p>
</div>
<div class="paragraph">
<p>We will therefore need to be able to assign a person to an existing organization by selecting an existing organization in the field.
For this we modify the organization field on the person to a smart field.
To display the assigned organizations we will also modify the person page accordingly.</p>
</div>
<div class="paragraph">
<p>In addition we would like to be able to easily access all persons assigned to a specific organization.
Using the existing organization page we will add a child page that will then show all associated persons.
This will result in a drill-down functionality for the organization page.</p>
</div>
<div class="paragraph">
<p>The implementation of the features described above can be achieved by the the following steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating an Organization Lookup Call (<a href="#sec-contacts_company_lookup_call">Creating an Organization Lookup Call</a>)</p>
</li>
<li>
<p>Using the Lookup Call in the Person Form and the Person Table (<a href="#sec-contacts_modify_person_form_and_page">Using the Lookup Call in the Person Form and the Person Table</a>)</p>
</li>
<li>
<p>Link the Person Page to Organizations (<a href="#sec-contacts_organization_node_page">Link the Person Page to Organizations</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This last tutorial step ends with a short review in <a href="#sec-contacts_link_person_organization_summary">What have we achieved?</a></p>
</div>
<div class="sect2">
<h3 id="sec-contacts_company_lookup_call"><a class="anchor" href="#sec-contacts_company_lookup_call"></a>Creating an Organization Lookup Call</h3>
<div class="paragraph">
<p>Before we can change the organization field on the person form from a string field to a smart field we need a organization lookup call that provides the necessary data to the smartfield.
We have been using this approach for the country field already.
The difference to the lookup call for countries lies in the fact that we no longer have a static list of entries but need to fetch possible the organizations dynamically.
We will therefore need to access the database to provide the data to the lookup call.</p>
</div>
<div class="paragraph">
<p>As this is a common requirement the Scout framework comes with the base class <code>AbstractSqlLookupService</code> and a default mechanism to route lookup calls from the frontend sever to database calls on the backend server.
The necessary infrastructure can be created using the Scout lookup wizard according to the steps described below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand folder <code>src/main/java</code> in the shared module in the package explorer</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.shared.organization</code></p>
</li>
<li>
<p>For IntelliJ</p>
<div class="ulist">
<ul>
<li>
<p>Create a new Scout lookup call by right-clicking on the package and selecting <code>New &#8594; Scout Element &#8594; Lookup Call</code> as shown in <a href="#img-sdk_create_new_lookupcall_organization_Intellij">Figure 49</a></p>
</li>
<li>
<p>Enter "Organization" into the name field as shown in <a href="#img-sdk_new_lookupcall_organization_Intellij">Figure 50</a> and press <kbd>Enter</kbd>.</p>
</li>
<li>
<p>In the generated lookup call, change the generic from <code>&lt;Long&gt;</code> to <code>&lt;String&gt;</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse</p>
<div class="ulist">
<ul>
<li>
<p>Hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>N</kbd></span></p>
</li>
<li>
<p>Enter "lookup" into the search field of the wizard selection and double click on proposal <em class="element">Scout LookupCall</em></p>
</li>
<li>
<p>Use "OrganizationLookupCall" as class name</p>
</li>
<li>
<p>Enter "String" as the key class and use service super class "AbstractSqlLookupService" in the wizard</p>
</li>
<li>
<p>Verify that the fields in the wizard match the values provided in <a href="#img-sdk_new_lookupcall_organization">Figure 51</a></p>
</li>
<li>
<p>Click <b class="button">Finish</b></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="img-sdk_create_new_lookupcall_organization_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_create_new_lookupcall_organization_Intellij.png" alt="sdk create new lookupcall organization Intellij">
</div>
<div class="title">Figure 49. Creating the OrganizationLookupCall in IntelliJ.</div>
</div>
<div id="img-sdk_new_lookupcall_organization_Intellij" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_lookupcall_organization_Intellij.png" alt="sdk new lookupcall organization Intellij">
</div>
<div class="title">Figure 50. Using the Scout lookup call wizard for creating class OrganizationLookupCall in IntelliJ.</div>
</div>
<div id="img-sdk_new_lookupcall_organization" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_lookupcall_organization.png" alt="sdk new lookupcall organization">
</div>
<div class="title">Figure 51. Using the Scout lookup call wizard for creating class OrganizationLookupCall in Eclipse.</div>
</div>
<div class="paragraph">
<p>The Scout wizard creates the lookup class <code>OrganizationLookupCall</code> and the corresponding lookup service with the interface <code>IOrganizationLookupService</code> and its initial implementation <code>OrganizationLookupService</code>.
Beside making sure the generic uses the correct data type (<code>String</code>), the service interface and the lookup call class can be used as provided by the Scout wizard.
We will only need to provide some implementation for the lookup service.
<a href="#lst-contacts_lookup_call_organization">Listing 48</a> shows the generated code for the lookup call.</p>
</div>
<div id="lst-contacts_lookup_call_organization" class="listingblock">
<div class="title">Listing 48. The OrganizationLookupCall implemented by the Scout wizard.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("22789824-ad89-4208-bc11-5c08b56ce998")
public class OrganizationLookupCall extends LookupCall&lt;String&gt; {

  private static final long serialVersionUID = 1L;

  @Override
  protected Class&lt;? extends ILookupService&lt;String&gt;&gt; getConfiguredService() {
    return IOrganizationLookupService.class;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are now ready to implement method <code>getConfiguredSqlSelect</code> of the organization lookup service.
Open class <code>OrganizationLookupService</code> in the Java editor and change the implementation according to <a href="#lst-contacts_lookup_service_organization">Listing 49</a>.</p>
</div>
<div id="lst-contacts_lookup_service_organization" class="listingblock">
<div class="title">Listing 49. The OrganizationService methods to load, create and update organization data.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class OrganizationLookupService
    extends AbstractSqlLookupService&lt;String&gt;
    implements IOrganizationLookupService {

  @Override
  protected String getConfiguredSqlSelect() {
    return SQLs.ORGANIZATION_LOOKUP; <i class="conum" data-value="1"></i><b>(1)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We only need to return a single SQL statement for lookup services that extend <code>AbstractSqlLookupService</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The SQL statement that backs the lookup service is provided in <a href="#lst-contacts_lookup_service_sql">Listing 50</a>.
Lookup services can provide data for three different use cases.
The most straightforward case is the mapping of a key to a specific lookup row.
Next is the case where the lookup service returns a number of lookup rows that match a provided substring and finally the case where the lookup service simply returns all available rows.</p>
</div>
<div id="lst-contacts_lookup_service_sql" class="listingblock">
<div class="title">Listing 50. The SQL statement to provide the data for the organization lookup service.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  String ORGANIZATION_LOOKUP = ""
      + "SELECT   organization_id, "
      + "         name "
      + "FROM     ORGANIZATION "
      + "WHERE    1 = 1 "
      + "&lt;key&gt;    AND organization_id = :key&lt;/key&gt; " <i class="conum" data-value="1"></i><b>(1)</b>
      + "&lt;text&gt;   AND UPPER(name) LIKE UPPER(:text||'%') &lt;/text&gt; " <i class="conum" data-value="2"></i><b>(2)</b>
      + "&lt;all&gt;&lt;/all&gt;"; <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The where clause to be used for a search for a specific key</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The where clause to be used when some search text is provided</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The where clause that defines the full set of lookup rows</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_modify_person_form_and_page"><a class="anchor" href="#sec-contacts_modify_person_form_and_page"></a>Using the Lookup Call in the Person Form and the Person Table</h3>
<div class="paragraph">
<p>Now we can use the organization lookup call to transform the organization field in the "Work" tab of the person form into a smart field.
To do this we open class <code>PersonForm</code> in the Java editor and navigate to its inner class <code>WorkBox</code>.
Then, update the implementation of the OrganizationField according to <a href="#lst-contacts_organization_smart_field">Listing 51</a></p>
</div>
<div id="lst-contacts_organization_smart_field" class="listingblock">
<div class="title">Listing 51. The organization smart field in the "Work" tab backed by the OrganizationLookupCall.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">      @Order(20)
      @ClassId("8e18a673-aca5-44a2-898f-60a744e4467a")
      public class WorkBox extends AbstractGroupBox {

        @Order(20)
        @ClassId("cd4a7afd-e0ac-4c79-bf2e-819aa491db27")
        public class OrganizationField extends AbstractSmartField&lt;String&gt; { <i class="conum" data-value="1"></i><b>(1)</b>

          @Override
          protected String getConfiguredLabel() {
            return TEXTS.get("Organization");
          }

          @Override <i class="conum" data-value="2"></i><b>(2)</b>
          protected Class&lt;? extends ILookupCall&lt;String&gt;&gt; getConfiguredLookupCall() {
            return OrganizationLookupCall.class;
          }
        }
      }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The OrganizationField now extends a Scout smart field</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The smart field is backed by the newly created organization lookup call</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This change has the effect, that now we can assign an organization in the person form by typing a substring of the organizations name into the organization field.
The conversion of the field into a smart field has the additional benefit that only valid organizations can be selected that respect the referential integrity defined by the database.</p>
</div>
<div class="paragraph">
<p>As a next step we also modify the organization column of the person page.
For this open class <code>PersonTablePage</code> in the Java editor and navigate to its inner class <code>Table</code>.
Then, change the implementation of <code>OrganizationColumn</code> according to <a href="#lst-contacts_organization_smart_column">Listing 52</a>.</p>
</div>
<div id="lst-contacts_organization_smart_column" class="listingblock">
<div class="title">Listing 52. The organization smart column in the person page.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @ClassId("3fa1374b-9635-441b-b2f8-feb24b50740a")
  public class Table extends AbstractTable {

    @Order(9)
    @ClassId("2e53e50e-5bd5-421e-8bca-fc50f27d790b")
    public class OrganizationColumn extends AbstractSmartColumn&lt;String&gt; {

      @Override
      protected String getConfiguredHeaderText() {
        return TEXTS.get("Organization");
      }

      @Override
      protected Class&lt;? extends ILookupCall&lt;String&gt;&gt; getConfiguredLookupCall() {
        return OrganizationLookupCall.class;
      }
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the created organization lookup calls we have now completed the modifications on the person form and also used the lookup call to display the a person&#8217;s organization in the person page.
The next section will focus on the necessary modifications and new components to re-use the person page as a sub page of the organization page.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_organization_node_page"><a class="anchor" href="#sec-contacts_organization_node_page"></a>Link the Person Page to Organizations</h3>
<div class="paragraph">
<p>In this section we will implement a drill-down functionality on the organization page.
The goal is to let the user of the application expand a row in the organization page to provide access to the persons of the organization.</p>
</div>
<div class="paragraph">
<p>Scout node pages are useful when we want to display different entities that are related to a specific entry in a parent page.
In the "Contacts" demo application this mechanism is used to link both persons and events to an organization as shown in <a href="#img-contacts_demo_organization_nodepage">Figure 52</a>.
Note that this is a screenshot of the "Contacts" demo application, not the tutorial application that we are building here.</p>
</div>
<div id="img-contacts_demo_organization_nodepage" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_demo_organization_nodepage.png" alt="contacts demo organization nodepage">
</div>
<div class="title">Figure 52. A drill-down on an organization in the "Contacts" demo application provides access to related persons and events.</div>
</div>
<div class="paragraph">
<p>In the "Contacts" demo application this hierarchical page structure is implemented as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Organization page implemented in class <code>OrganizationTablePage</code></p>
<div class="ulist">
<ul>
<li>
<p>A node page implemented in class <code>OrganizationNodePage</code></p>
<div class="ulist">
<ul>
<li>
<p>Person page implemented in class <code>OrganizationTablePage</code></p>
</li>
<li>
<p>Event page implemented in class <code>EventTablePage</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the "Contacts" tutorial application we will create the exact same structure but only add the person page as child page to the organization node page.</p>
</div>
<div class="paragraph">
<p>To implement this sequence of linked pages we will follow the dependencies of the linked classes.
We start with adapting method <code>getPersonTableData</code> in the person service by adding an organization id parameter.
Using this parameter we can then restrict the person search to the subset that is linked to the specified organization.
For this change we first update the person service interface as shown in <a href="#lst-contacts_ipersonservice">Listing 53</a>.</p>
</div>
<div id="lst-contacts_ipersonservice" class="listingblock">
<div class="title">Listing 53. The updated method <code>getPersonTableData</code> for the person service interface.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@TunnelToServer
public interface IPersonService {

  PersonTablePageData getPersonTableData(SearchFilter filter, String organizationId); <i class="conum" data-value="1"></i><b>(1)</b>

  PersonFormData create(PersonFormData formData);

  PersonFormData load(PersonFormData formData);

  PersonFormData store(PersonFormData formData);
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add parameter <code>organizationId</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We now adapt the method implementation in the person service according to <a href="#lst-contacts_personservice_organization">Listing 54</a>.</p>
</div>
<div id="lst-contacts_personservice_organization" class="listingblock">
<div class="title">Listing 54. Method getPersonTableData to access the database and map the data into a page data object.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonService implements IPersonService {

	@Override
	public PersonTablePageData getPersonTableData(SearchFilter filter, String organizationId) {
		PersonTablePageData pageData = new PersonTablePageData();
		StringBuilder sql = new StringBuilder(SQLs.PERSON_PAGE_SELECT);

		// if an organization is defined, restrict result set to persons that are linked to it
		if (StringUtility.hasText(organizationId)) {
			sql.append(String.format("WHERE LOWER(organization_id) LIKE LOWER('%s') ",
					organizationId));
		}

		sql.append(SQLs.PERSON_PAGE_DATA_SELECT_INTO);
		SQL.selectInto(sql.toString(), new NVPair("page", pageData));

		return pageData;
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having modified the person service we add a organization id property to the person page.
We can then populate this property when the person page is attached to the organization node page.
Finally, we can use in method <code>execLoadData</code> according to <a href="#lst-contacts_person_page_modification">Listing 55</a>.</p>
</div>
<div id="lst-contacts_person_page_modification" class="listingblock">
<div class="title">Listing 55. Add the possibility to restrict the list of persons to those assigned to a specific organization.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PageData(PersonTablePageData.class)
@ClassId("23c10251-66b1-4bd6-a9d7-93c7d1aedede")
public class PersonTablePage extends AbstractPageWithTable&lt;Table&gt; {

  private String organizationId; <i class="conum" data-value="1"></i><b>(1)</b>

  public String getOrganizationId() {
    return organizationId;
  }

  public void setOrganizationId(String organizationId) {
    this.organizationId = organizationId;
  }

  @Override
  protected void execLoadData(SearchFilter filter) {
    importPageData(BEANS.get(IPersonService.class)
        .getPersonTableData(filter, getOrganizationId())); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  @ClassId("3fa1374b-9635-441b-b2f8-feb24b50740a")
  public class Table extends AbstractTable {

    @Order(20)
    @ClassId("8ac358f2-de17-4b2b-93f3-73e21a7415d8")
    public class NewMenu extends AbstractMenu {

      @Override
      protected void execAction() {
        PersonForm form = new PersonForm();
        form.getOrganizationField().setValue(getOrganizationId()); <i class="conum" data-value="3"></i><b>(3)</b>
        form.addFormListener(new PersonFormListener());
        // start the form using its new handler
        form.startNew();
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This property lets the person page remember an organization key</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Provides the organization key to the person search on the backend server</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If the user creates a new person below an organization pre-fill the corresponding field</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the cases where the modified person page is shown as a child page of the organization page we can now improve the usability of the page&#8217;s new menu.
When creating a person under an existing organization we create the new person with a pre-filled organization id.
See the modified <code>execAction</code> method in <code>NewMenu</code> of <a href="#lst-contacts_person_page_modification">Listing 55</a>.</p>
</div>
<div class="paragraph">
<p>The next step in the setup of the page hierarchy is the creation of the organization node page.
Node pages allow to define a list of child pages that typically represent different entities.
As mentioned before we will only have the person page as a child page in the "Contacts" tutorial application.</p>
</div>
<div class="paragraph">
<p>To create the organization node page follow the steps listed below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expand folder <code>src/main/java</code> in the client module in the package explorer</p>
</li>
<li>
<p>Select package <code>org.eclipse.scout.contacts.client.organization</code></p>
</li>
<li>
<p>For IntelliJ</p>
<div class="ulist">
<ul>
<li>
<p>Create a new Scout page by right-clicking on the package and selecting <code>New &#8594; Scout Element &#8594; Page</code> as we&#8217;ve done before</p>
</li>
<li>
<p>Enter "OrganizationNode" into the name field and press <kbd>Enter</kbd></p>
</li>
<li>
<p>Finally, rename "OrganizationNodeTablePage" to "OrganizationNodePage"</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Eclipse</p>
<div class="ulist">
<ul>
<li>
<p>Hit <span class="keyseq"><kbd>Ctrl</kbd>+<kbd>N</kbd></span> and enter "scout page" into the search field of the wizard selection and double click on proposal <em class="element">Scout Page</em></p>
</li>
<li>
<p>Add "Organization" to the class name field</p>
</li>
<li>
<p>Switch the super class field to "AbstractPageWithNodes"</p>
</li>
<li>
<p>Verify that the fields in the wizard match the values provided in <a href="#img-sdk_new_organization_nodepage">Figure 53</a></p>
</li>
<li>
<p>Click <b class="button">Finish</b></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="img-sdk_new_organization_nodepage" class="imageblock">
<div class="content">
<img src="../common/_images/sdk_new_organization_nodepage.png" alt="sdk new organization nodepage">
</div>
<div class="title">Figure 53. Creating the organization node page.</div>
</div>
<div class="paragraph">
<p>After the wizard has created the initial implementation of the node page, open class <code>OrganizationNodePage</code> in the Java editor and adapt its implementation according to <a href="#lst-contacts_organization_node_page">Listing 56</a>.</p>
</div>
<div id="lst-contacts_organization_node_page" class="listingblock">
<div class="title">Listing 56. The complete implementation of the class <code>OrganizationNodePage</code>.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ClassId("f074181d-462a-40dc-b7cd-46bb4e50e7fb")
public class OrganizationNodePage extends AbstractPageWithNodes {

  private String organizationId; <i class="conum" data-value="1"></i><b>(1)</b>

  public String getOrganizationId() {
    return organizationId;
  }

  public void setOrganizationId(String organizationId) {
    this.organizationId = organizationId;
  }

  @Override <i class="conum" data-value="2"></i><b>(2)</b>
  protected void execCreateChildPages(List&lt;IPage&lt;?&gt;&gt; pageList) {
    PersonTablePage personTablePage = new PersonTablePage();
    personTablePage.setOrganizationId(getOrganizationId()); <i class="conum" data-value="3"></i><b>(3)</b>
    pageList.add(personTablePage);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The organization id property that represents the selected organization in the parent page</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Method <code>execCreateChildPages</code> defines the list of child pages</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the organization id property for the person child page</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We have now created an organization node page that contains a person page as its child page.
The only missing step to create the discussed page hierarchy is the link between the organization page with the organization node page.
Create this missing link by adding method <code>execCreateChildPage</code> to the organization page as shown in <a href="#lst-contacts_organization_page_modification">Listing 57</a>.</p>
</div>
<div id="lst-contacts_organization_page_modification" class="listingblock">
<div class="title">Listing 57. Add the organization node page as a child page to the organization page.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@PageData(OrganizationTablePageData.class)
@ClassId("18f7a78e-0dd0-4e4e-9234-99892bb4459f")
public class OrganizationTablePage extends AbstractPageWithTable&lt;Table&gt; {

  @Override
  protected IPage&lt;?&gt; execCreateChildPage(ITableRow row) {
    OrganizationNodePage childPage = new OrganizationNodePage();
    childPage.setOrganizationId(getTable().getOrganizationIdColumn().getValue(row));
    return childPage;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The difference between Scout table pages and node pages is also reflected in the different signatures of <code>AbstractPageWithTable.execCreateChildPage</code> and <code>AbstractPageWithNodes.execCreateChildPages</code>.
Table pages can have a single child page while node pages may contain a list of child pages.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-contacts_link_person_organization_summary"><a class="anchor" href="#sec-contacts_link_person_organization_summary"></a>What have we achieved?</h3>
<div class="paragraph">
<p>In the seventh step of the "Contacts" tutorial we have introduced a typical Scout user interface pattern for 1:n relationships.
We have created a dynamic lookup call and used the lookup call to provide the data for a smart field and a smart column.</p>
</div>
<div class="paragraph">
<p>To implement a drill-down functionality for the organization table we have created a page hierarchy using the existing organization page and person page.
To link the two table pages we have also created and integrated a Scout node page.</p>
</div>
<div class="paragraph">
<p>The "Contacts" application is in a clean state again and you can (re)start the backend and the frontend of the application and verify the result in your browser.
As shown in <a href="#img-contacts_tutorial_result_step_7">Figure 54</a> the organization specific person data is now presented in a hierarchical form in the navigation area of the application.</p>
</div>
<div id="img-contacts_tutorial_result_step_7" class="imageblock">
<div class="content">
<img src="../common/_images/contacts_tutorial_result_step_7.png" alt="contacts tutorial result step 7">
</div>
<div class="title">Figure 54. The linked person page only shows persons related to the parent organization page.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-source_control"><a class="anchor" href="#sec-source_control"></a>Git configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to add the created application to a Git repository there might some configurations be helpful. If there are no plans to use Git, this chapter can be skipped.</p>
</div>
<div class="paragraph">
<p>E.g. it is best practice to exclude some files from adding to a Git repository. These exclusions can be configured by creating a file named <code>.gitignore</code> in the root folder of the repository (see the <a href="https://git-scm.com/docs/gitignore">Git Documentation</a> for details).
Here is a sample file that might be used as starting point:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Git
*.orig

# Maven
target/
.surefire-*
.flattened-pom.xml

# Node
node_modules/
test-results/

# Do not check in any log files
*.log</pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="deploy-to-tomcat.html">Build Scout App and Deploy to Tomcat</a></span>
  <span class="next"><a href="helloscout-js.html">Hello Scout JS</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using Antora.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
